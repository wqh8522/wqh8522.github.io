[{"title":"SpringBoot持久化层","date":"2017-10-05T14:26:18.000Z","path":"2017/10/05/SpringBoot持久化层/","content":"<h2 id=\"使用Spring-Data-Jpa操作数据库\"><a href=\"#使用Spring-Data-Jpa操作数据库\" class=\"headerlink\" title=\"使用Spring Data Jpa操作数据库\"></a>使用Spring Data Jpa操作数据库</h2><h2 id=\"事务处理\"><a href=\"#事务处理\" class=\"headerlink\" title=\"事务处理\"></a>事务处理</h2><h2 id=\"SpringBoot整合Mybatis\"><a href=\"#SpringBoot整合Mybatis\" class=\"headerlink\" title=\"SpringBoot整合Mybatis\"></a>SpringBoot整合Mybatis</h2><h2 id=\"SpringBoot整合Hibernate\"><a href=\"#SpringBoot整合Hibernate\" class=\"headerlink\" title=\"SpringBoot整合Hibernate\"></a>SpringBoot整合Hibernate</h2>","tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"http://www.wanqhblog.top/tags/SpringBoot/"},{"name":"Data-Jpa","slug":"Data-Jpa","permalink":"http://www.wanqhblog.top/tags/Data-Jpa/"},{"name":"mybatis","slug":"mybatis","permalink":"http://www.wanqhblog.top/tags/mybatis/"},{"name":"hibernate","slug":"hibernate","permalink":"http://www.wanqhblog.top/tags/hibernate/"}]},{"title":"SpringBoot入门","date":"2017-10-05T01:40:20.000Z","path":"2017/10/05/SpringBoot入门/","content":"<h2 id=\"Spring中常用注解\"><a href=\"#Spring中常用注解\" class=\"headerlink\" title=\"Spring中常用注解\"></a>Spring中常用注解</h2><h3 id=\"声明Bean的注解\"><a href=\"#声明Bean的注解\" class=\"headerlink\" title=\"声明Bean的注解\"></a>声明Bean的注解</h3><ul>\n<li><strong>@Component：</strong>声明类为组件，没有明确的角色；</li>\n<li><strong>@Service：</strong>声明该类在业务逻辑层（service层）使用；</li>\n<li><strong>@Reponsitory：</strong>在数据访问层（dao层）使用；</li>\n<li><strong>@Controller：</strong>表现层（MVC-&gt;SpringMVC）使用；<br>四个注解效果几乎等效，主要是区别类的作用，是层次更清晰。</li>\n<li><strong>@Scope：</strong>描述Spring容器如何新建Bean实例，<ul>\n<li><strong>Singleton：</strong>单例，一个Spring容器中只有一个Bean实例，Spring默认为该配置</li>\n<li><strong>Prototype：</strong>每次调用新建一个Bean实例</li>\n<li><strong>Request：</strong>web项目中，给每一个http request新建一个Bean实例</li>\n<li><strong>Session：</strong>web项目中，给每一个http session新建一个Bean实例</li>\n<li><strong>GlobalSession：</strong>这个只在portal应用中有用，给每一个global http session新建一个bean实例 <h3 id=\"注入Bean的注解\"><a href=\"#注入Bean的注解\" class=\"headerlink\" title=\"注入Bean的注解\"></a>注入Bean的注解</h3></li>\n</ul>\n</li>\n<li><strong>@Autowired:</strong>自动装配，Spring提供的注解；<a id=\"more\"></a>默认按类型装配，默认情况下必须要求依赖对象必须存在，如果要允许null 值，可以设置它的required属性为false，如：@Autowired(required=false) ，如果我们想使用名称装配可以结合<strong>@Qualifier</strong>注解进行使用</li>\n<li><strong>@Resource：</strong>JSR-250提供的注解；默认安照名称进行装配，名称可以通过name属性进行指定，如果没有指定name属性，当注解写在字段上时，默认取字段名进行按照名称查找，如果注解写在setter方法上默认取属性名进行装配。 当找不到与名称匹配的bean时才按照类型进行装配。但是需要注意的是，如果name属性一旦指定，就只会按照名称进行装配。</li>\n<li><strong>@Inject：</strong>JSR-330提供的注解。与<strong>@Autowired</strong>基本一样，按类型装配，可以通过<strong>@Qualifier</strong>显式指定装配类型<br>这三个注解可在set方法或者属性上，个人觉得注解在属性上更好，优点是代码少，层次更清晰。<h3 id=\"Java配置注解\"><a href=\"#Java配置注解\" class=\"headerlink\" title=\"Java配置注解\"></a>Java配置注解</h3></li>\n<li><strong>@Configuration：</strong>声明当前类是一个配置类，该类相当于Spring一个xml配置文件。这个类中可能有0个或多个@Bean注解。也可以不使用包扫描，因为所有的Bean都在此类中定义。</li>\n<li><strong>@Bean：</strong>注解在方法上，声明当前方法返回的是值为一个Bean；如果</li>\n<li><p><strong>@ComponentScan：</strong>自动扫描指定包名下所有使用<strong>@Servcie</strong>、<strong>@Reponsitory</strong>、<strong>@Controller</strong>和<strong>@Component</strong>的类，并注册为Bean。<br>使用java配置方式的Spring程序，可以使用<strong>AnnotationConfigApplicationContext</strong>作为Spring容器，接受输入一个配置类作为参数，然后使用<strong>genBean()</strong>获取配置的Bean。</p>\n<h3 id=\"AOP注解\"><a href=\"#AOP注解\" class=\"headerlink\" title=\"AOP注解\"></a>AOP注解</h3><p>AOP：面向切面编程，相对于OOP面向对象编程；Spring的AOP的存在是为了解耦,AOP可以让一组类共享相同行为。在OOP中只能通过继承类和实现接口来使代码的耦合度增强，且继承是能为单继承，阻碍更多行为添加到一组类上，AOP弥补了OOP的不足。<br>Spring支持AspectJ的注解式切面编程。</p>\n</li>\n<li><p><strong>@Aspect:</strong>声明是一个切面；</p>\n</li>\n<li><strong>@Before：</strong>定义切点，定义为前置通知</li>\n<li><strong>@After：</strong>定义为后置通知</li>\n<li><strong>@Around：</strong>定义为环绕通知，其中参数为切点</li>\n<li><strong>@PointCut：</strong>定义统一的拦截规则，上面的通知可以引用</li>\n</ul>\n<p>如果是使用java配置方式的Spring程序，需要在配置类上使用<strong>@EnableAspectJAutoProxy</strong>开启对AspectJ代理的支持。</p>\n<h3 id=\"Spring-EL和资源调用注解\"><a href=\"#Spring-EL和资源调用注解\" class=\"headerlink\" title=\"Spring EL和资源调用注解\"></a>Spring EL和资源调用注解</h3><p>Spring EL表达式支持在xml和注解中使用，类似于jsp的EL表达式。</p>\n<ul>\n<li><strong>@PropertySource:</strong>指定资源文件地址，</li>\n<li><strong>@Value：</strong>其中的参数为读取资源信息，也可以使用该注解注入，这样就需要配置一个PropertySourcePalceholderConfigurer的Bean。<h3 id=\"Bean的初始化和销毁\"><a href=\"#Bean的初始化和销毁\" class=\"headerlink\" title=\"Bean的初始化和销毁\"></a>Bean的初始化和销毁</h3>使用JSR250形式的Bean</li>\n<li><strong>@PostConstruct：</strong>在构造函数执行完之后执行</li>\n<li><strong>@PerDestory：</strong>在Bean销毁之前执行<br>在<strong>@Bean</strong>注解中可以指定属性：initMethod和destoryMethod指定类的init和destory方法在构造之后、bean销毁之前执行。<h3 id=\"异步注解\"><a href=\"#异步注解\" class=\"headerlink\" title=\"异步注解\"></a>异步注解</h3></li>\n<li><strong>@EnableAsync：</strong>注解开启异步任务支持，在配置类中使用</li>\n<li><strong>@Async：</strong>表明该方法是个异步方法，如果该注解用在类上，则表明该类所有的方法都是异步方法。<h3 id=\"计划任务\"><a href=\"#计划任务\" class=\"headerlink\" title=\"计划任务\"></a>计划任务</h3></li>\n<li><strong>@EnableScheduling：</strong>在配置类来开启对计划任务的支持，</li>\n<li><strong>@Schedule：</strong>声明这是一个计划任务，使用fixedRate属性每个固定时间执行，cron可按照指定时间执行，cron是UNIX和类UNIX系统下的定时任务。<h3 id=\"测试注解\"><a href=\"#测试注解\" class=\"headerlink\" title=\"测试注解\"></a>测试注解</h3></li>\n<li><strong>@ContextConfiguration：</strong>加载配置ApplicationContext，其中class属性用来加载配置类</li>\n<li><strong>@ActiveProfile：</strong>用来声明活动的profile<h3 id=\"Spring-MVC注解\"><a href=\"#Spring-MVC注解\" class=\"headerlink\" title=\"Spring MVC注解\"></a>Spring MVC注解</h3></li>\n<li><strong>@Controller：</strong>声明该类是一个控制器</li>\n<li><strong>@RequestMapping：</strong>配置URL和方法之间的映射</li>\n<li><strong>@ResponseBody：</strong>支持将返回值放在response体内，而不是返回一个页面；此注解可放在返回值钱或者方法前。返回一般为json数据</li>\n<li><strong>@RequestBody：</strong>允许request的参数放在request体内，而不是直接在地址后面，此注解放在参数钱</li>\n<li><strong>@PathVariable：</strong>用来接收路径参数</li>\n<li><strong>@RestController:</strong>组合注解，组合了@Controller和@ResponseBody</li>\n<li><strong>@ControllerAdvice：</strong>可以将对于控制器的全局配置放置在同一个位置</li>\n<li><strong>@ExceptionHandler:</strong>用于全局处理控制里的异常，</li>\n<li><strong>@InitBinder：</strong>用来设置WebDataBinder，<strong>WebDataBinder</strong>用来自动绑定前台参数到Model中</li>\n<li><strong>@ModelAttribute：</strong>绑定键值对到Model里，<strong>@ControllerAdvice</strong>注解标注的类中是让全局的@RequestMapping都能获得到在此处设置的键值对。<h3 id=\"其他注解\"><a href=\"#其他注解\" class=\"headerlink\" title=\"其他注解\"></a>其他注解</h3></li>\n<li><strong>@Profile：</strong>为在不同环境下使用不同的配置提供支持</li>\n<li><strong>@ConfigurationProperties：</strong>绑定指定的properties中的值，并且支持层级关系。</li>\n<li><strong>@Primary：</strong> 标志这个 Bean 如果在多个同类 Bean 候选时，该 Bean 优先被考虑。</li>\n<li><strong>@Conditional：</strong>根据满足某一特定条件创建一个特定的Bean</li>\n<li><strong>@EnableWebMvc：</strong>开启Web MVC的配置支持</li>\n<li><strong>@EnableConfigurationProperties：</strong>开启对<strong>@ConfigurationProperties</strong>注解配置Bean的支持</li>\n<li><strong>@EnableTransactionManagement:</strong>开启对注解式事务的支持</li>\n<li><strong>@EnableCaching：</strong>开启注解式的缓存支持<h2 id=\"SpringBoot简介\"><a href=\"#SpringBoot简介\" class=\"headerlink\" title=\"SpringBoot简介\"></a>SpringBoot简介</h2><blockquote>\n<p>Spring Boot是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的配置。通过这种方式，Spring Boot致力于在蓬勃发展的快速应用开发领域(rapid application development)成为领导者。</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ol>\n<li>快速构建项目；</li>\n<li>对主流开发框架的无配置集成；</li>\n<li>项目可独立运行，无须外部依赖Servlet容器；</li>\n<li>提供运行时的应用监控；</li>\n<li>极大地提高了开发、部署效率；</li>\n<li>与云计算的天然集成。</li>\n</ol>\n<h2 id=\"创建第一个SpringBoot应用\"><a href=\"#创建第一个SpringBoot应用\" class=\"headerlink\" title=\"创建第一个SpringBoot应用\"></a>创建第一个SpringBoot应用</h2><p>可以使用Spring网站在线创建：<a href=\"https://start.spring.io/\" target=\"_blank\" rel=\"external\">https://start.spring.io/</a><br><img src=\"https://i.imgur.com/09JwCTm.png\" alt=\"\"><br>下载完解压后就能得到一个标准的maven项目，这里也可以选择gradle方式<br><img src=\"https://i.imgur.com/XURuy7w.png\" alt=\"\"><br>使用IDE创建，这里使用IDEA创建：<br>选择Spring Initializr，在右边选择jdk版本<br><img src=\"https://i.imgur.com/fsAi30r.png\" alt=\"\"><br>修改填写maven的一些属性，这里的Java Version要与前面的版本对应<br><img src=\"https://i.imgur.com/8mnotun.png\" alt=\"\"><br>选择SpringBoot的版本以及需要添加的依赖<br><img src=\"https://i.imgur.com/nfymcBB.png\" alt=\"\"><br>最后就是项目名称<br><img src=\"https://i.imgur.com/YCAnc3f.png\" alt=\"\"><br>创建完成的项目结构：<br><img src=\"https://i.imgur.com/4F2kGUw.png\" alt=\"\"><br>添加一个Controller并启动项目测试：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@RestController</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Hello</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"/hello\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">hello</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span>  <span class=\"string\">\"Hello SpringBoot\"</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@SpringBootApplication</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoApplication</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</div><div class=\"line\">\t\tSpringApplication.run(DemoApplication.class, args);</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>访问：<a href=\"http://localhost:8080/hello\" target=\"_blank\" rel=\"external\">http://localhost:8080/hello</a><br><img src=\"https://i.imgur.com/QtGfbag.png\" alt=\"\"></p>\n<h2 id=\"表单验证\"><a href=\"#表单验证\" class=\"headerlink\" title=\"表单验证\"></a>表单验证</h2><p>创建一个学生类，添加学生信息验证学生年龄最小为20岁，学生姓名不能为空：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Students</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> String id;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@NotNull</span>(message = <span class=\"string\">\"姓名必传\"</span>)</div><div class=\"line\">    <span class=\"keyword\">private</span> String name;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//@Min 该注解限制字段的最小值</span></div><div class=\"line\">    <span class=\"meta\">@Min</span>(value = <span class=\"number\">20</span> ,message = <span class=\"string\">\"未满20岁的学生禁止注册！！\"</span>)</div><div class=\"line\">    <span class=\"keyword\">private</span> Integer age;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Students</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> id;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(String id)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.id = id;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> name;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String name)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.name = name;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">getAge</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> age;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setAge</span><span class=\"params\">(Integer age)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.age = age;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"Students&#123;\"</span> +</div><div class=\"line\">                <span class=\"string\">\"id='\"</span> + id + <span class=\"string\">'\\''</span> +</div><div class=\"line\">                <span class=\"string\">\", name='\"</span> + name + <span class=\"string\">'\\''</span> +</div><div class=\"line\">                <span class=\"string\">\", age=\"</span> + age +</div><div class=\"line\">                <span class=\"string\">'&#125;'</span>;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/** 日志打印 */</span></div><div class=\"line\">   <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> Logger logger = LoggerFactory.getLogger(Hello.class);</div><div class=\"line\"></div><div class=\"line\">   <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">    * <span class=\"doctag\">@Valid</span> 表示该对象需要验证</span></div><div class=\"line\"><span class=\"comment\">    * <span class=\"doctag\">@param</span> student </span></div><div class=\"line\"><span class=\"comment\">    * <span class=\"doctag\">@param</span> bindingResult 验证返回的信息</span></div><div class=\"line\"><span class=\"comment\">    * <span class=\"doctag\">@return</span></span></div><div class=\"line\"><span class=\"comment\">    */</span></div><div class=\"line\">   <span class=\"meta\">@PostMapping</span>(<span class=\"string\">\"/saveStudent\"</span>)</div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">saveStudent</span><span class=\"params\">(@Valid Students student,BindingResult bindingResult)</span></span>&#123;</div><div class=\"line\">       <span class=\"keyword\">if</span>(bindingResult.hasErrors())&#123;</div><div class=\"line\">           <span class=\"comment\">//如果失败，打印并返回验证结果</span></div><div class=\"line\">           String error = bindingResult.getFieldError().getDefaultMessage();<span class=\"comment\">//获取错误信息</span></div><div class=\"line\">           logger.info(String.format(<span class=\"string\">\"errorMsg=&#123;&#125;\"</span>),error+<span class=\"string\">\"age:\"</span>+student.getAge());</div><div class=\"line\">           <span class=\"keyword\">return</span> error;</div><div class=\"line\">       &#125;</div><div class=\"line\">       <span class=\"keyword\">return</span> student;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure>\n<p><img src=\"https://i.imgur.com/2xKpn9f.png\" alt=\"\"><br><img src=\"https://i.imgur.com/d5jrdmg.png\" alt=\"\"></p>\n<h2 id=\"统一异常处理\"><a href=\"#统一异常处理\" class=\"headerlink\" title=\"统一异常处理\"></a>统一异常处理</h2><p>@ControllerAdvice:使用该注解标注的类，表明该类是Controller的全局配置类；<br>@ExceptionHandler：全局处理控制器的异常<br>自定义异常类<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">**</div><div class=\"line\"> * Created By wqh</div><div class=\"line\"> * <span class=\"number\">2017</span>/<span class=\"number\">9</span>/<span class=\"number\">24</span>   <span class=\"number\">15</span>:<span class=\"number\">13</span></div><div class=\"line\"> * Description: 自定义异常，只有继承RuntimeException才能被Spring的hadler捕获</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StudentExceprion</span> <span class=\"keyword\">extends</span> <span class=\"title\">RuntimeException</span></span>&#123;</div><div class=\"line\">    <span class=\"keyword\">private</span> Integer code;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">StudentExceprion</span><span class=\"params\">(ResultEnum resultEnum)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">super</span>(resultEnum.getMessage());</div><div class=\"line\">        <span class=\"keyword\">this</span>.code = resultEnum.getCode();</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">getCode</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> code;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setCode</span><span class=\"params\">(Integer code)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.code = code;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * Created By wqh</span></div><div class=\"line\"><span class=\"comment\"> * 2017/9/24 14:50</span></div><div class=\"line\"><span class=\"comment\"> * Description:返回结果的封装的工具类</span></div><div class=\"line\"><span class=\"comment\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ResultUtil</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ResponseResult <span class=\"title\">success</span><span class=\"params\">(Object object)</span></span>&#123;</div><div class=\"line\">        ResponseResult responseResult = <span class=\"keyword\">new</span> ResponseResult();</div><div class=\"line\">        responseResult.setCode(<span class=\"number\">1</span>);</div><div class=\"line\">        responseResult.setMessage(<span class=\"string\">\"成功\"</span>);</div><div class=\"line\">        responseResult.setData(object);</div><div class=\"line\">        <span class=\"keyword\">return</span> responseResult;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span>  ResponseResult <span class=\"title\">success</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"keyword\">null</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ResponseResult <span class=\"title\">error</span><span class=\"params\">(Integer code,String content)</span></span>&#123;</div><div class=\"line\">        ResponseResult&lt;Students&gt; responseResult = <span class=\"keyword\">new</span> ResponseResult&lt;&gt;();</div><div class=\"line\">        responseResult.setCode(code);</div><div class=\"line\">        responseResult.setMessage(content);</div><div class=\"line\">        <span class=\"keyword\">return</span> responseResult;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>控制层全局配置类<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@ControllerAdvice</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ExceptionHandle</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@ExceptionHandler</span>(value = Exception.class)</div><div class=\"line\">    <span class=\"meta\">@ResponseBody</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ResponseResult <span class=\"title\">handle</span><span class=\"params\">(Exception e)</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span>(e <span class=\"keyword\">instanceof</span> StudentExceprion)&#123;</div><div class=\"line\">            StudentExceprion studentExceprion = (StudentExceprion) e;</div><div class=\"line\">            <span class=\"keyword\">return</span> ResultUtil.error(studentExceprion.getCode(),studentExceprion.getMessage());</div><div class=\"line\">        &#125;<span class=\"keyword\">else</span> &#123;</div><div class=\"line\"></div><div class=\"line\">            <span class=\"keyword\">return</span> ResultUtil.error(ResultEnum.UNKNOW_ERROR.getCode(),ResultEnum.UNKNOW_ERROR.getMessage());</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * Created By wqh</span></div><div class=\"line\"><span class=\"comment\"> * 2017/9/24   15:26</span></div><div class=\"line\"><span class=\"comment\"> * Description: 返回结果的枚举类</span></div><div class=\"line\"><span class=\"comment\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span>  ResultEnum &#123;</div><div class=\"line\">    UNKNOW_ERROR (-<span class=\"number\">1</span>,<span class=\"string\">\"未知错误\"</span>),</div><div class=\"line\">    SUCCESS(<span class=\"number\">1</span>,<span class=\"string\">\"成功\"</span>),</div><div class=\"line\">    PRIMARY_ERROR(<span class=\"number\">100</span>,<span class=\"string\">\"你可能在上小学\"</span>),</div><div class=\"line\">    MIDDLE_ERROR(<span class=\"number\">101</span>,<span class=\"string\">\"你可能在上初中\"</span>),</div><div class=\"line\">    WORK_ERROR(<span class=\"number\">102</span>,<span class=\"string\">\"你可能在打工\"</span>);</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">private</span> Integer code;</div><div class=\"line\">    <span class=\"keyword\">private</span> String message;</div><div class=\"line\"></div><div class=\"line\">    ResultEnum(Integer code, String message) &#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.code = code;</div><div class=\"line\">        <span class=\"keyword\">this</span>.message = message;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">getCode</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> code;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getMessage</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> message;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * Created By wqh</span></div><div class=\"line\"><span class=\"comment\"> * 2017/9/24 14:43</span></div><div class=\"line\"><span class=\"comment\"> * Description: 相应结果的封装</span></div><div class=\"line\"><span class=\"comment\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ResponseResult</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</div><div class=\"line\"></div><div class=\"line\">   <span class=\"comment\">/** 响应码 */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> Integer code;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/** 响应信息 */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> String message;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/** 数据 */</span></div><div class=\"line\">    <span class=\"keyword\">private</span> T data;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">getCode</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> code;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setCode</span><span class=\"params\">(Integer code)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.code = code;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getMessage</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> message;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMessage</span><span class=\"params\">(String message)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.message = message;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">getData</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> data;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setData</span><span class=\"params\">(T data)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.data = data;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getAge</span><span class=\"params\">(String id)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</div><div class=\"line\">    Students stu = studentDao.findOne(id);</div><div class=\"line\">    <span class=\"keyword\">if</span>(stu.getAge()&lt;<span class=\"number\">10</span>)&#123;</div><div class=\"line\">        <span class=\"comment\">//抛出自定义异常</span></div><div class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> StudentExceprion(ResultEnum.PRIMARY_ERROR);</div><div class=\"line\">    &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (stu.getAge()&gt;<span class=\"number\">10</span> &amp;&amp; stu.getAge()&lt;<span class=\"number\">15</span>)&#123;</div><div class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> StudentExceprion(ResultEnum.MIDDLE_ERROR);</div><div class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</div><div class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> StudentExceprion(ResultEnum.WORK_ERROR);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>在控制层直接调用Service层既可，但是异常需要往外抛，交给统一的处理</p>\n<h2 id=\"单元测试\"><a href=\"#单元测试\" class=\"headerlink\" title=\"单元测试\"></a>单元测试</h2><p>使用Junit进行单元测试时很重要的，这里分别介绍测试service和dao层<br>添加测试依赖<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"测试Service层\"><a href=\"#测试Service层\" class=\"headerlink\" title=\"测试Service层\"></a>测试Service层</h3><p>Service层的测试比较简单，只要将Serice的Bean注入到测试类中。但是在SpringBoot中的测试类，需要在类上添加两个注解<strong>@RunWith(SpringRunner.class)、@SpringBootTest</strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Autowired</span></div><div class=\"line\">  <span class=\"keyword\">private</span> StudentService studentService;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"meta\">@Test</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">saveStus</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</div><div class=\"line\"></div><div class=\"line\">      Students student = <span class=\"keyword\">new</span> Students();</div><div class=\"line\">      student.setAge(<span class=\"number\">155</span>);</div><div class=\"line\">      student.setName(<span class=\"string\">\"wqeqwasd\"</span>);</div><div class=\"line\">      student.setMoney(<span class=\"number\">13</span>d);</div><div class=\"line\">      studentService.saveStus(student);</div><div class=\"line\"></div><div class=\"line\">  &#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"测试Controller层\"><a href=\"#测试Controller层\" class=\"headerlink\" title=\"测试Controller层\"></a>测试Controller层</h3><p>在开发Rest风格API时，对于Controller层的测试也是相当重要的；<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@RunWith</span>(SpringRunner.class)</div><div class=\"line\"><span class=\"meta\">@SpringBootTest</span></div><div class=\"line\"><span class=\"meta\">@AutoConfigureMockMvc</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StudentActionTest</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Autowired</span></div><div class=\"line\">    <span class=\"keyword\">private</span> MockMvc mockMvc;</div><div class=\"line\">    <span class=\"meta\">@Test</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">save</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</div><div class=\"line\">        mockMvc.perform(MockMvcRequestBuilders.post(<span class=\"string\">\"/studentAction/save\"</span>)</div><div class=\"line\">                                                .param(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"wqh\"</span>)</div><div class=\"line\">                                                .param(<span class=\"string\">\"age\"</span>,<span class=\"string\">\"50\"</span>))<span class=\"comment\">//添加参数</span></div><div class=\"line\">                .andExpect(MockMvcResultMatchers.status().isOk())<span class=\"comment\">//返回状态码为200</span></div><div class=\"line\">                .andDo(print())<span class=\"comment\">//打印出请求和相应的内容</span></div><div class=\"line\">                .andReturn().getResponse().getContentAsString();<span class=\"comment\">//将返回信息转化为String类型</span></div><div class=\"line\"><span class=\"comment\">//                .andExpect(MockMvcResultMatchers.content().string(\"ww\"));//返回结果必须是ww</span></div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h2 id=\"SpringBoot实现热部署\"><a href=\"#SpringBoot实现热部署\" class=\"headerlink\" title=\"SpringBoot实现热部署\"></a>SpringBoot实现热部署</h2><p>SpringBoot热部署是使用了spring-boot-devtools工具：<br>添加依赖<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--热部署功能--&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-devtools<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">optional</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">optional</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>Pom文件build中添加<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">fork</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">fork</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>IDEA配置<br>当我们修改了Java类后，IDEA默认是不自动编译的，而spring-boot-devtools又是监测classpath下的文件发生变化才会重启应用，所以需要设置IDEA的自动编译：<br><img src=\"https://i.imgur.com/S8SPCWm.png\" alt=\"\"></p>\n<h2 id=\"学习资料汇总\"><a href=\"#学习资料汇总\" class=\"headerlink\" title=\"学习资料汇总\"></a>学习资料汇总</h2><h3 id=\"推荐博客\"><a href=\"#推荐博客\" class=\"headerlink\" title=\"推荐博客\"></a>推荐博客</h3><ul>\n<li><a href=\"http://blog.didispace.com/categories/Spring-Boot/\" target=\"_blank\" rel=\"external\">程序猿DD</a></li>\n<li><a href=\"http://blog.csdn.net/liaokailin/article/category/5765237\" target=\"_blank\" rel=\"external\">liaokailin的专栏</a></li>\n<li><a href=\"http://blog.720ui.com/columns/springboot_all/\" target=\"_blank\" rel=\"external\">Spring Boot 揭秘与实战 系列</a></li>\n<li><a href=\"http://blog.csdn.net/column/details/spring-boot.html\" target=\"_blank\" rel=\"external\">catoop的专栏</a></li>\n<li><a href=\"http://www.jianshu.com/c/f0cf6eae1754\" target=\"_blank\" rel=\"external\">简书Spring Boot专题</a></li>\n<li><a href=\"http://blog.csdn.net/column/details/15397.html\" target=\"_blank\" rel=\"external\">方志朋Spring Boot 专栏</a></li>\n<li><a href=\"http://lihao312.iteye.com/\" target=\"_blank\" rel=\"external\">Spring-boot集成</a></li>\n<li><a href=\"http://www.ityouknow.com/spring-boot\" target=\"_blank\" rel=\"external\">纯洁的微笑</a><h3 id=\"推荐网站\"><a href=\"#推荐网站\" class=\"headerlink\" title=\"推荐网站\"></a>推荐网站</h3></li>\n<li><a href=\"http://projects.spring.io/spring-boot/\" target=\"_blank\" rel=\"external\">Spring boot 官网</a></li>\n<li><a href=\"https://qbgbook.gitbooks.io/spring-boot-reference-guide-zh/content/\" target=\"_blank\" rel=\"external\">Spring Boot参考指南-中文版</a></li>\n<li><a href=\"https://dongchuan.gitbooks.io/gradle-user-guide-/content/tutorials/\" target=\"_blank\" rel=\"external\">Gradle 中文参考指南</a></li>\n<li><a href=\"http://www.imooc.com/learn/767\" target=\"_blank\" rel=\"external\">慕课网视频</a></li>\n<li><a href=\"http://www.mkyong.com/tutorials/spring-boot-tutorials/\" target=\"_blank\" rel=\"external\">spring-boot-tutorials</a><h3 id=\"开源代码\"><a href=\"#开源代码\" class=\"headerlink\" title=\"开源代码\"></a>开源代码</h3></li>\n<li><a href=\"https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples\" title=\"SpringBoot官方例子\" target=\"_blank\" rel=\"external\">SpringBoot官方例子</a></li>\n<li><a href=\"https://github.com/ityouknow/spring-boot-examples\" target=\"_blank\" rel=\"external\">spring-boot-examples</a></li>\n<li><a href=\"https://github.com/dyc87112/SpringBoot-Learning\" target=\"_blank\" rel=\"external\">SpringBoot-Learning</a></li>\n<li><a href=\"https://github.com/cloudfavorites/favorites-web\" target=\"_blank\" rel=\"external\">favorites-web</a></li>\n<li><a href=\"https://github.com/JeffLi1993/springboot-learning-example\" target=\"_blank\" rel=\"external\">springboot-learning-example</a></li>\n<li><a href=\"https://github.com/leelance/spring-boot-all\" target=\"_blank\" rel=\"external\">spring-boot-all</a></li>\n</ul>\n","tags":[{"name":"SpringBooot","slug":"SpringBooot","permalink":"http://www.wanqhblog.top/tags/SpringBooot/"}]},{"title":"Oracle新建用户","date":"2017-10-01T01:22:39.000Z","path":"2017/10/01/oracle新建用户/","content":"<p>1.首先我们可以用scott用户以sysdba的身份登录oracle.<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">conn scott/tiger as sysdba</div></pre></td></tr></table></figure></p>\n<p>2.然后我就可以来创建用户了.<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">user</span> <span class=\"keyword\">name</span> <span class=\"keyword\">identified</span> <span class=\"keyword\">by</span> <span class=\"keyword\">name</span>;</div></pre></td></tr></table></figure></p>\n<p>3.修改用户的密码. <a id=\"more\"></a><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">user</span> <span class=\"keyword\">name</span> <span class=\"keyword\">identified</span> <span class=\"keyword\">by</span> <span class=\"keyword\">password</span>;</div></pre></td></tr></table></figure></p>\n<p>4.创建一个表空间.<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">tablespace</span> tablespace_name <span class=\"keyword\">datafile</span> <span class=\"string\">'c:\\tablespace_name.dbf'</span> <span class=\"keyword\">size</span> <span class=\"number\">200</span>M;</div></pre></td></tr></table></figure></p>\n<p>5.创建好表空间,还需要将表空间分配给用户.<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">user</span> <span class=\"keyword\">name</span> <span class=\"keyword\">default</span> <span class=\"keyword\">tablespace</span> tablespacename;</div></pre></td></tr></table></figure></p>\n<p>6.给用户分配了表空间,用户还不能登陆（没有登录权限）,因此还需要为用户分配权限<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">grant</span> <span class=\"keyword\">create</span> <span class=\"keyword\">session</span>,<span class=\"keyword\">create</span> <span class=\"keyword\">table</span>,<span class=\"keyword\">create</span> <span class=\"keyword\">view</span>,<span class=\"keyword\">create</span> <span class=\"keyword\">sequence</span>,<span class=\"keyword\">unlimited</span> <span class=\"keyword\">tablespace</span> <span class=\"keyword\">to</span> tablespace_name;</div></pre></td></tr></table></figure></p>\n<p>7.删除user<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">user</span> ×× <span class=\"keyword\">cascade</span></div></pre></td></tr></table></figure></p>\n<p>8.说明： 删除了user，只是删除了该user下的schema objects，是不会删除相应的tablespace的。<br>删除tablespace<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLESPACE</span> tablespace_name <span class=\"keyword\">INCLUDING</span> <span class=\"keyword\">CONTENTS</span> <span class=\"keyword\">AND</span> <span class=\"keyword\">DATAFILES</span>;</div></pre></td></tr></table></figure></p>\n","tags":[{"name":"oracle","slug":"oracle","permalink":"http://www.wanqhblog.top/tags/oracle/"}]},{"title":"Oeacle常见的日期处理","date":"2017-09-27T11:51:00.000Z","path":"2017/09/27/Oeacle日期/","content":"<h2 id=\"日期处理常用函数\"><a href=\"#日期处理常用函数\" class=\"headerlink\" title=\"日期处理常用函数\"></a>日期处理常用函数</h2><ol>\n<li>sysdate：当前日期和时间；</li>\n<li>to_char()：将数值型或日期型转换为字符型；</li>\n<li>to_date()：日期转换函数，例：to_date(‘2017-09-27 10:00:00’, ‘yyyy-mm-dd hh24:mi:ss’)；</li>\n<li>last_day(sysdate)：返回日期所在月的最后一天；</li>\n<li>trunc(number[,decimals])：指定元素格式截去一部分日期值；</li>\n<li>add_months(D,N)：返回日期D加N月后对应的日期时间，N为正时则表示D之后；N为负时则表示为D之前；N为小数则会自动先删除小数部分，而用整数部分;<a id=\"more\"></a></li>\n<li>decode(条件,值1,翻译值1,值2,翻译值2,…值n,翻译值n,缺省值)：根据条件返回相应的值；</li>\n<li>ceil(n)：取大于等于数值n的最小整数；</li>\n<li>floor(n)：取小于等于数值n的最大整数；</li>\n<li>dbtimezone()：返回时区；</li>\n<li>……<h2 id=\"常见操作\"><a href=\"#常见操作\" class=\"headerlink\" title=\"常见操作\"></a>常见操作</h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">--得到当前的日期</span></div><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">sysdate</span> <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--取得当前日期是本月的第几周</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'YYYYMMDD HH24:MI:SS W'</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'w'</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--取得当前日期是一个星期中的第几天,注意星期日是第一天 返回的是number 1开始星期天</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'d'</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'yyyy'</span>) <span class=\"keyword\">from</span> dual;<span class=\"comment\">--取得年</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'q'</span>) <span class=\"keyword\">from</span> dual;<span class=\"comment\">--取得季度</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'mm'</span>) <span class=\"keyword\">from</span> dual;<span class=\"comment\">--取得月份</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'dd'</span>) <span class=\"keyword\">from</span> dual;<span class=\"comment\">--取得日期</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'ddd'</span>) <span class=\"keyword\">from</span> dual;<span class=\"comment\">-- 一年中的第几天</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'ww'</span>) <span class=\"keyword\">from</span> dual; <span class=\"comment\">-- 年中的第几个星期</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'w'</span>) <span class=\"keyword\">from</span> dual;  <span class=\"comment\">-- 该月的第几个信息</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'day'</span>) <span class=\"keyword\">from</span> dual; <span class=\"comment\">--星期几</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'hh'</span>) <span class=\"keyword\">from</span> dual; <span class=\"comment\">--小时 12小时制</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'hh24'</span>) <span class=\"keyword\">from</span> dual; <span class=\"comment\">--小时 24小时制</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'MI'</span>) <span class=\"keyword\">from</span> dual; <span class=\"comment\">--分</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'ss'</span>) <span class=\"keyword\">from</span> dual; <span class=\"comment\">--秒</span></div><div class=\"line\">  </div><div class=\"line\"><span class=\"comment\">--得到当天凌晨0点0分0秒的日期</span></div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">sysdate</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\">  </div><div class=\"line\"><span class=\"comment\">--得到这天的最后一秒</span></div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">sysdate</span>)+<span class=\"number\">0.99999</span> <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--得到小时的具体数值</span></div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">sysdate</span>)+<span class=\"number\">1</span>/<span class=\"number\">24</span> <span class=\"keyword\">from</span> dual;</div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">sysdate</span>)+<span class=\"number\">7</span>/<span class=\"number\">24</span> <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--得到明天凌晨0点0分0秒的日期</span></div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">sysdate</span>+<span class=\"number\">1</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">sysdate</span>)+<span class=\"number\">1</span> <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--本月一日的日期</span></div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'mm'</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--下月一日的日期</span></div><div class=\"line\"><span class=\"keyword\">select</span> trunc(add_months(<span class=\"keyword\">sysdate</span>, <span class=\"number\">1</span>),<span class=\"string\">'mm'</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--返回当前月的最后一天</span></div><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">last_day</span>(<span class=\"keyword\">sysdate</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">last_day</span>(trunc(<span class=\"keyword\">sysdate</span>)) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">last_day</span>(<span class=\"keyword\">sysdate</span>)) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"><span class=\"keyword\">select</span> trunc(add_months(<span class=\"keyword\">sysdate</span>,<span class=\"number\">1</span>),<span class=\"string\">'mm'</span>) - <span class=\"number\">1</span> <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--得到一年的每一天</span></div><div class=\"line\"><span class=\"keyword\">select</span> trunc(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'yyyy'</span>)+ rn <span class=\"number\">-1</span> date0 <span class=\"keyword\">from</span></div><div class=\"line\">(<span class=\"keyword\">select</span> <span class=\"keyword\">rownum</span> rn <span class=\"keyword\">from</span> all_objects</div><div class=\"line\"><span class=\"keyword\">where</span> <span class=\"keyword\">rownum</span>&lt;<span class=\"number\">366</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--给现有的日期加上2年</span></div><div class=\"line\"><span class=\"keyword\">select</span> add_months(<span class=\"keyword\">sysdate</span>,<span class=\"number\">24</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--判断某一日子所在年分是否为润年</span></div><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">decode</span>(to_char(<span class=\"keyword\">last_day</span>(trunc(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'y'</span>)+<span class=\"number\">31</span>),<span class=\"string\">'dd'</span>),<span class=\"string\">'29'</span>,<span class=\"string\">'闰年'</span>,<span class=\"string\">'平年'</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--判断两年后是否为润年</span></div><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">decode</span>(to_char(<span class=\"keyword\">last_day</span>(trunc(add_months(<span class=\"keyword\">sysdate</span>,<span class=\"number\">24</span>),<span class=\"string\">'y'</span>)+<span class=\"number\">31</span>),<span class=\"string\">'dd'</span>),<span class=\"string\">'29'</span>,<span class=\"string\">'闰年'</span>,<span class=\"string\">'平年'</span>) <span class=\"keyword\">from</span> dual;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--查询当前日期的季度</span></div><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">ceil</span>(to_number(to_char(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'mm'</span>))/<span class=\"number\">3</span>) <span class=\"keyword\">from</span> dual;</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"案例\"><a href=\"#案例\" class=\"headerlink\" title=\"案例\"></a>案例</h2><p>根据时间以及用户id计算该用户本周、本日、本月记录的数据<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">-- 本日 </span></div><div class=\"line\"><span class=\"keyword\">select</span> y.create_by,<span class=\"keyword\">count</span>(y.create_date),u.name <span class=\"keyword\">from</span> <span class=\"keyword\">test</span> y,sys_user u</div><div class=\"line\"> <span class=\"keyword\">where</span> <span class=\"keyword\">to_date</span>(y.create_date)=<span class=\"keyword\">to_date</span>(<span class=\"keyword\">sysdate</span>) <span class=\"keyword\">and</span> y.create_by=u.id</div><div class=\"line\"><span class=\"keyword\">group</span> <span class=\"keyword\">by</span> y.create_by,u.name;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--本周</span></div><div class=\"line\"><span class=\"keyword\">select</span> create_by,<span class=\"keyword\">count</span>(create_date)</div><div class=\"line\"><span class=\"keyword\">from</span> <span class=\"keyword\">test</span></div><div class=\"line\"><span class=\"keyword\">where</span> <span class=\"keyword\">to_date</span>(create_date)&gt;=<span class=\"keyword\">to_date</span>(<span class=\"keyword\">sysdate</span>-to_number(to_char(<span class=\"keyword\">sysdate</span><span class=\"number\">-1</span>,<span class=\"string\">'D'</span>))) <span class=\"keyword\">and</span> slzt=<span class=\"string\">'1'</span></div><div class=\"line\"><span class=\"keyword\">group</span> <span class=\"keyword\">by</span> create_by;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">--本月</span></div><div class=\"line\"><span class=\"keyword\">select</span> to_char(create_date,<span class=\"string\">'yyyy-mm'</span>),create_by,<span class=\"keyword\">count</span>(create_date) <span class=\"keyword\">from</span> <span class=\"keyword\">test</span></div><div class=\"line\"><span class=\"keyword\">where</span> <span class=\"keyword\">to_date</span>(create_date)&gt;=<span class=\"keyword\">to_date</span>(trunc(<span class=\"keyword\">sysdate</span>,<span class=\"string\">'mm'</span>)) <span class=\"keyword\">and</span> <span class=\"keyword\">to_date</span>(create_date)&lt;=<span class=\"keyword\">to_date</span>(<span class=\"keyword\">last_day</span>(<span class=\"keyword\">sysdate</span>))</div><div class=\"line\"><span class=\"keyword\">group</span> <span class=\"keyword\">by</span> to_char(create_date,<span class=\"string\">'yyyy-mm'</span>),create_by;</div></pre></td></tr></table></figure></p>\n","tags":[{"name":"oracle","slug":"oracle","permalink":"http://www.wanqhblog.top/tags/oracle/"}]},{"title":"SpringAOP的使用","date":"2017-08-28T02:10:56.000Z","path":"2017/08/28/SpringAOP/","content":"<h2 id=\"什么是AOP\"><a href=\"#什么是AOP\" class=\"headerlink\" title=\"什么是AOP\"></a>什么是AOP</h2><p>AOP（Aspect Oriented Programming 面向切面编程），通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术。AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。</p>\n<p>常用于日志记录，性能统计，安全控制，事务处理，异常处理等等。</p>\n<h2 id=\"定义AOP术语\"><a href=\"#定义AOP术语\" class=\"headerlink\" title=\"定义AOP术语\"></a>定义AOP术语</h2><a id=\"more\"></a>\n<p>切面（Aspect）：切面是一个关注点的模块化，这个关注点可能是横切多个对象；</p>\n<p>连接点（Join Point）：连接点是指在程序执行过程中某个特定的点，比如某方法调用的时候或者处理异常的时候；</p>\n<p>通知（Advice）：指在切面的某个特定的连接点上执行的动作。Spring切面可以应用5中通知：</p>\n<ul>\n<li>前置通知（Before）:在目标方法或者说连接点被调用前执行的通知；</li>\n<li>后置通知（After）：指在某个连接点完成后执行的通知；</li>\n<li>返回通知（After-returning）：指在某个连接点成功执行之后执行的通知；</li>\n<li>异常通知（After-throwing）：指在方法抛出异常后执行的通知；</li>\n<li>环绕通知（Around）：指包围一个连接点通知，在被通知的方法调用之前和之后执行自定义的方法。</li>\n</ul>\n<p>切点（Pointcut）：指匹配连接点的断言。通知与一个切入点表达式关联，并在满足这个切入的连接点上运行，例如：当执行某个特定的名称的方法。</p>\n<p>引入（Introduction）：引入也被称为内部类型声明，声明额外的方法或者某个类型的字段。</p>\n<p>目标对象（Target Object）：目标对象是被一个或者多个切面所通知的对象。</p>\n<p>AOP代理（AOP Proxy）：AOP代理是指AOP框架创建的对对象，用来实现切面契约（包括通知方法等功能）</p>\n<p>织入（Wearving）：指把切面连接到其他应用出程序类型或者对象上，并创建一个被通知的对象。或者说形成代理对象的方法的过程。</p>\n<p><img src=\"http://i.imgur.com/NNwG4Yz.png\" alt=\"\"></p>\n<h2 id=\"Spring对AOP的支持\"><a href=\"#Spring对AOP的支持\" class=\"headerlink\" title=\"Spring对AOP的支持\"></a>Spring对AOP的支持</h2><ol>\n<li>基于代理的经典SpringAOP；</li>\n<li>纯POJO切面；</li>\n<li>@AspectJ注解驱动的切面；</li>\n<li>注入式AspectJ切面（适用于Spring各版本）；</li>\n</ol>\n<p>前三种都是SpringAOP实现的变体，SpringAOP构建在动态代理基础之上，因此，Spring对AOP的支持局限于方法的拦截。</p>\n<h2 id=\"切入点表达式\"><a href=\"#切入点表达式\" class=\"headerlink\" title=\"切入点表达式\"></a>切入点表达式</h2><p><img src=\"http://i.imgur.com/z8MbDIP.png\" alt=\"\"></p>\n<h2 id=\"使用SpringAOP\"><a href=\"#使用SpringAOP\" class=\"headerlink\" title=\"使用SpringAOP\"></a>使用SpringAOP</h2><p>SpringAOP的支持必须呀导入spring-aspects的jar包<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency&gt;</div><div class=\"line\">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div class=\"line\">    &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;</div><div class=\"line\">    &lt;version&gt;4.3.5.RELEASE&lt;/version&gt;</div><div class=\"line\">&lt;/dependency&gt;</div></pre></td></tr></table></figure></p>\n<h3 id=\"使用注解定义切面\"><a href=\"#使用注解定义切面\" class=\"headerlink\" title=\"使用注解定义切面\"></a>使用注解定义切面</h3><p>采用注解的方式定义切面以及通知</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Aspect</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Audience</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//使用@Pointcut注解声明频繁使用的切入点表达式</span></div><div class=\"line\">    <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"execution(* com.wqh.concert.Performance.perform(..))\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">performance</span><span class=\"params\">()</span></span>&#123;&#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Before</span>(<span class=\"string\">\"performance()\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">silenceCellPhones</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"Sillencing cell phones\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@Before</span>(<span class=\"string\">\"performance()\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">takeSeats</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"Task Seat\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@AfterReturning</span>(<span class=\"string\">\"performance()\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">applause</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"CLAP CLAP CLAP\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"meta\">@AfterThrowing</span>(<span class=\"string\">\"performance()\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">demandRefund</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"Demand a Refund\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>另外需要在applicationContext.xml也就是spring的配置文件中添加配置：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!--启用AspectJ的自动代理--&gt;</div><div class=\"line\">&lt;aop:aspectj-autoproxy/&gt;</div><div class=\"line\">&lt;!--声明bean--&gt;</div><div class=\"line\">&lt;bean <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.concert.Audience\"</span>/&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"在XML中声明切面\"><a href=\"#在XML中声明切面\" class=\"headerlink\" title=\"在XML中声明切面\"></a>在XML中声明切面</h3><p>定义pojo类，这里只是把上面定义的注解全public class AudienceXML {<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">silenceCellPhones</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    System.out.println(<span class=\"string\">\"Sillencing cell phones\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">takeSeats</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    System.out.println(<span class=\"string\">\"Task Seat\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">applause</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    System.out.println(<span class=\"string\">\"CLAP CLAP CLAP\"</span>);</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">demandRefund</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">    System.out.println(<span class=\"string\">\"Demand a Refund\"</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>applicationContext.xml配置<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!--声明bean--&gt;</div><div class=\"line\">&lt;bean name=<span class=\"string\">\"audienceXML\"</span> <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.concert.AudienceXML\"</span>/&gt;</div><div class=\"line\">&lt;aop:config&gt;</div><div class=\"line\">    &lt;!--引入bean--&gt;</div><div class=\"line\">    &lt;aop:aspect ref=<span class=\"string\">\"audienceXML\"</span>&gt;</div><div class=\"line\">        &lt;!--定义切点--&gt;</div><div class=\"line\">        &lt;aop:pointcut id=<span class=\"string\">\"perform\"</span></div><div class=\"line\">                      expression=<span class=\"string\">\"execution(* com.wqh.concert.Performance.perform(..))\"</span>/&gt;</div><div class=\"line\">        &lt;!--定义通知</div><div class=\"line\">            method：通知，也就是具体的方法</div><div class=\"line\">            pointcut-ref：引用的切点</div><div class=\"line\">            pointcut：切点--&gt;</div><div class=\"line\">        &lt;aop:before method=<span class=\"string\">\"silenceCellPhones\"</span></div><div class=\"line\">                    pointcut-ref=<span class=\"string\">\"perform\"</span>/&gt;</div><div class=\"line\"></div><div class=\"line\">        &lt;aop:before method=<span class=\"string\">\"takeSeats\"</span> pointcut-ref=<span class=\"string\">\"perform\"</span>/&gt;</div><div class=\"line\">        &lt;aop:after-returning method=<span class=\"string\">\"applause\"</span> pointcut-ref=<span class=\"string\">\"perform\"</span>/&gt;</div><div class=\"line\"></div><div class=\"line\">        &lt;aop:after-throwing method=<span class=\"string\">\"demandRefund\"</span></div><div class=\"line\">                            pointcut=<span class=\"string\">\"execution(* com.wqh.concert.Performance.perform(..))\"</span>/&gt;</div><div class=\"line\">    &lt;/aop:aspect&gt;</div><div class=\"line\">&lt;/aop:config&gt;</div></pre></td></tr></table></figure></p>\n<p><img src=\"http://i.imgur.com/uGg9KUl.png\" alt=\"\"></p>\n<h2 id=\"环绕通知\"><a href=\"#环绕通知\" class=\"headerlink\" title=\"环绕通知\"></a>环绕通知</h2><p>在springAOP中有五种通知，环绕通知是最为强大的通知。它能够让你编写的逻辑将被通知的目标方法完全包装起来。实际上就像在一个通知方法中同时编写前置通知和后置通知。<br>本片文章具体讲解环绕通知的使用。</p>\n<h3 id=\"使用注解\"><a href=\"#使用注解\" class=\"headerlink\" title=\"使用注解\"></a>使用注解</h3><p>使用环绕通知定义切面：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Aspect</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AudienceAround</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//使用@Pointcut注解声明频繁使用的切入点表达式</span></div><div class=\"line\">    <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"execution(* com.wqh.concert.Performance.perform(..))\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">performance</span><span class=\"params\">()</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Around</span>(<span class=\"string\">\"performance()\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">watchPerformance</span><span class=\"params\">(ProceedingJoinPoint joinPoint)</span></span>&#123;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            System.out.println(<span class=\"string\">\"Silencing cell phones\"</span>);</div><div class=\"line\">            System.out.println(<span class=\"string\">\"Taking seats\"</span>);</div><div class=\"line\">            joinPoint.proceed();</div><div class=\"line\">            System.out.println(<span class=\"string\">\"Demanding a refund\"</span>);</div><div class=\"line\"></div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Throwable throwable) &#123;</div><div class=\"line\">            throwable.printStackTrace();</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>可以看到在上面的代码中，定义通知的时候在通知方法中添加了入参：ProceedingJoinPoint。在创建环绕通知的时候，这个参数是必须写的。因为在需要在通知中使用ProceedingJoinPoint.proceed()方法调用被通知的方法。</p>\n<p>另外，如果忘记调用proceed()方法，那么通知实际上会阻塞对被通知方法的调用。</p>\n<h3 id=\"在XML中定义\"><a href=\"#在XML中定义\" class=\"headerlink\" title=\"在XML中定义\"></a>在XML中定义</h3><p>首先去掉上面类的所有注解：这里为了区别就重新创建一个类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AudienceAroundXML</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">watchPerformance</span><span class=\"params\">(ProceedingJoinPoint joinPoint)</span></span>&#123;</div><div class=\"line\">        <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">            System.out.println(<span class=\"string\">\"Silencing cell phones\"</span>);</div><div class=\"line\">            System.out.println(<span class=\"string\">\"Taking seats\"</span>);</div><div class=\"line\">            joinPoint.proceed();</div><div class=\"line\">            System.out.println(<span class=\"string\">\"Demanding a refund\"</span>);</div><div class=\"line\"></div><div class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Throwable throwable) &#123;</div><div class=\"line\">            throwable.printStackTrace();</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>配置：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!--声明bean--&gt;</div><div class=\"line\">&lt;bean name=<span class=\"string\">\"audienceAroundXML\"</span> <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.concert.AudienceAroundXML\"</span>/&gt;</div><div class=\"line\">\t&lt;!--配置切面及通知--&gt;</div><div class=\"line\">&lt;aop:config&gt;</div><div class=\"line\">    &lt;aop:aspect ref=<span class=\"string\">\"audienceAroundXML\"</span>&gt;</div><div class=\"line\">        &lt;aop:pointcut id=<span class=\"string\">\"performance\"</span></div><div class=\"line\">                      expression=<span class=\"string\">\"execution(* com.wqh.concert.Performance.perform(..))\"</span>/&gt;</div><div class=\"line\">        &lt;aop:around method=<span class=\"string\">\"watchPerformance\"</span> pointcut-ref=<span class=\"string\">\"performance\"</span>/&gt;</div><div class=\"line\">    &lt;/aop:aspect&gt;</div><div class=\"line\">&lt;/aop:config&gt;</div></pre></td></tr></table></figure>\n<h2 id=\"处理通知中的参数\"><a href=\"#处理通知中的参数\" class=\"headerlink\" title=\"处理通知中的参数\"></a>处理通知中的参数</h2><h3 id=\"Spring借助AspectJ的切点表达式语言来定义Spring切面\"><a href=\"#Spring借助AspectJ的切点表达式语言来定义Spring切面\" class=\"headerlink\" title=\"Spring借助AspectJ的切点表达式语言来定义Spring切面\"></a>Spring借助AspectJ的切点表达式语言来定义Spring切面</h3><p><img src=\"http://i.imgur.com/fXL2qhm.png\" alt=\"\"></p>\n<p>在spring中尝试使用其他指示器时，会抛出IllegalArgument-Exception异常。</p>\n<p>如上的这些指示器，只有exception指示器是实际执行匹配的，而其他都是用来限制匹配的。</p>\n<h3 id=\"切面表达式分析\"><a href=\"#切面表达式分析\" class=\"headerlink\" title=\"切面表达式分析\"></a>切面表达式分析</h3><p>带参数的切点表达式分解</p>\n<p><img src=\"http://i.imgur.com/1QRixjd.png\" alt=\"\"></p>\n<p>在该切点表达式中使用了args(trackNumber)限定符。表示传递给playTrack()方法的int类型参数也会传递到通知中去。参数名trackNumber也与切点方法签名中的参数相匹配。</p>\n<h3 id=\"创建切面\"><a href=\"#创建切面\" class=\"headerlink\" title=\"创建切面\"></a>创建切面</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Aspect</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TrackCounter</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"execution(* com.wqh.aop.CompactDisc.playTrack(int))&amp;&amp;args(trackNumber)\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">trackPlayder</span><span class=\"params\">(<span class=\"keyword\">int</span> trackNumber)</span></span>&#123;&#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"meta\">@Before</span>(<span class=\"string\">\"trackPlayder(trackNumber)\"</span>)</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">countTrack</span><span class=\"params\">(<span class=\"keyword\">int</span> trackNumber)</span> </span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"前置通知:targetNumber=\"</span> + trackNumber);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"连接点类\"><a href=\"#连接点类\" class=\"headerlink\" title=\"连接点类\"></a>连接点类</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Service</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CompactDisc</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">playTrack</span><span class=\"params\">(<span class=\"keyword\">int</span> trackNumber)</span></span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"trackNumber =\"</span> + trackNumber);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"XML配置\"><a href=\"#XML配置\" class=\"headerlink\" title=\"XML配置\"></a>XML配置</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!--启用AspectJ的自动代理--&gt;</div><div class=\"line\">&lt;aop:aspectj-autoproxy/&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;!--声明bean--&gt;</div><div class=\"line\">\t&lt;bean <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.aop.TrackCounter\"</span>/&gt;</div><div class=\"line\">\t&lt;!--自动扫描包下的类--&gt;</div><div class=\"line\">&lt;context:component-scan base-<span class=\"keyword\">package</span>=<span class=\"string\">\"com.wqh.aop\"</span>/&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Test</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testT</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    ApplicationContext applicationContext =</div><div class=\"line\">            <span class=\"keyword\">new</span> ClassPathXmlApplicationContext(</div><div class=\"line\">                    <span class=\"keyword\">new</span> String[]&#123;<span class=\"string\">\"classpath:/spring/applicationContext.xml\"</span>&#125;);</div><div class=\"line\">    CompactDisc compactDisc = (CompactDisc) applicationContext.getBean(<span class=\"string\">\"compactDisc\"</span>);</div><div class=\"line\">    compactDisc.playTrack(<span class=\"number\">12</span>);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>上面给指定方法传入的参数是12，在通知中获取到了该参数</p>\n<p><img src=\"http://i.imgur.com/Zrr0oSB.png\" alt=\"\"></p>\n<p>另外：在xml中配置切面来处理通知中的参数，其实也差不多，只是把切点表达式放到了XML配置文件中。</p>\n<h2 id=\"给类添加新的功能\"><a href=\"#给类添加新的功能\" class=\"headerlink\" title=\"给类添加新的功能\"></a>给类添加新的功能</h2><h3 id=\"引入Spring实战中的知识\"><a href=\"#引入Spring实战中的知识\" class=\"headerlink\" title=\"引入Spring实战中的知识\"></a>引入Spring实战中的知识</h3><p>在SpringAOP中，我们可以为Bean引入新的方法。代理拦截器调用并委托给实现该方法的其他对象。<br><img src=\"http://i.imgur.com/0vLHPrw.png\" alt=\"\"></p>\n<p>当引入接口的方法被调用时，代理会把此调用委托给实现了新接口的某给其他对象。</p>\n<h3 id=\"使用注解方式引入\"><a href=\"#使用注解方式引入\" class=\"headerlink\" title=\"使用注解方式引入\"></a>使用注解方式引入</h3><h4 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h4><p>首先是连接点的接口及其实现类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Person</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">say</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ChinesePerson</span> <span class=\"keyword\">implements</span> <span class=\"title\">Person</span> </span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">say</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"说中文\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>创建需要添加的功能，这里个人类扩展一个吃的功能</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Food</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">eat</span><span class=\"params\">()</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ChineseFood</span> <span class=\"keyword\">implements</span> <span class=\"title\">Food</span> </span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Override</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">eat</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"吃中餐\"</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"编写切面\"><a href=\"#编写切面\" class=\"headerlink\" title=\"编写切面\"></a>编写切面</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Aspect</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">addFuction</span> </span>&#123;</div><div class=\"line\">    <span class=\"meta\">@DeclareParents</span>(value = <span class=\"string\">\"com.wqh.addfunction.Person+\"</span>,defaultImpl = ChineseFood.class)</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Food food;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>注意这里的表达式使用的式@DeclareParents注解；该注解所标注的静态属性指明了要引入的接口。<br>注解中使用的value属性指定哪种类型的bean要引入该接口，这里Person后后面的“+”号表示所有子类型，而不是该类的本身。defaultImpl，指定了为引入功能提供实现的类。</p>\n<p>使用XML配置bean：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!--启用AspectJ的自动代理--&gt;</div><div class=\"line\">&lt;aop:aspectj-autoproxy/&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;!--声明bean--&gt;</div><div class=\"line\">&lt;bean <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.addfunction.addFuction\"</span>/&gt;</div><div class=\"line\">&lt;bean name=<span class=\"string\">\"chinesePerson\"</span> <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.addfunction.ChinesePerson\"</span>/&gt;</div></pre></td></tr></table></figure></p>\n<h3 id=\"测试-1\"><a href=\"#测试-1\" class=\"headerlink\" title=\"测试\"></a>测试</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Test</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testAdd</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    ApplicationContext applicationContext = <span class=\"keyword\">new</span> ClassPathXmlApplicationContext(</div><div class=\"line\">            <span class=\"string\">\"classpath:spring/applicationContext.xml\"</span>);</div><div class=\"line\">    Person person = (Person) applicationContext.getBean(<span class=\"string\">\"chinesePerson\"</span>);</div><div class=\"line\">    person.say();</div><div class=\"line\">    <span class=\"comment\">//这里可以将chinesePerson bean转换为Food类，所以添加成功</span></div><div class=\"line\">    Food food = (Food) applicationContext.getBean(<span class=\"string\">\"chinesePerson\"</span>);</div><div class=\"line\">    food.eat();</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p><img src=\"http://i.imgur.com/znG9krq.png\" alt=\"\"></p>\n<h3 id=\"在XML中引入\"><a href=\"#在XML中引入\" class=\"headerlink\" title=\"在XML中引入\"></a>在XML中引入</h3><p>首先将上面的addFuction注解全部删除，其他不变；然后在xml中添加相应的配置：<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!--启用AspectJ的自动代理--&gt;</div><div class=\"line\">&lt;aop:aspectj-autoproxy/&gt;</div><div class=\"line\">&lt;!--声明bean--&gt;</div><div class=\"line\">&lt;bean name=<span class=\"string\">\"chinesePerson\"</span> <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.addfunction.ChinesePerson\"</span>/&gt;</div><div class=\"line\"></div><div class=\"line\"> &lt;aop:config&gt;</div><div class=\"line\">     &lt;aop:aspect&gt;</div><div class=\"line\">         &lt;aop:declare-parents types-matching=<span class=\"string\">\"com.wqh.addfunction.Person+\"</span></div><div class=\"line\">                              implement-<span class=\"class\"><span class=\"keyword\">interface</span></span>=<span class=\"string\">\"com.wqh.addfunction.Food\"</span></div><div class=\"line\">         <span class=\"keyword\">default</span>-impl=<span class=\"string\">\"com.wqh.addfunction.ChineseFood\"</span>/&gt;</div><div class=\"line\">     &lt;/aop:aspect&gt;</div><div class=\"line\"> &lt;/aop:config&gt;</div></pre></td></tr></table></figure></p>\n<p>这里的types-matching与上面的vale作用一样;<br><br>default-impl与defaultImpl作用一样，这也可以使用delegate-ref；当然如果使用delegate-ref则是要引用SpringBean；<br><br>implement-interface则是要引入的接口</p>\n","tags":[{"name":"spring","slug":"spring","permalink":"http://www.wanqhblog.top/tags/spring/"},{"name":"AOP","slug":"AOP","permalink":"http://www.wanqhblog.top/tags/AOP/"}]},{"title":"分析ClassLoader工作机制","date":"2017-08-26T03:54:25.000Z","path":"2017/08/26/classload/","content":"<p>ClassLoader：类加载器，作用：</p>\n<ol>\n<li>负责将Class加载到JVM中；</li>\n<li>审查每个类应该又谁来加载，是一个父优先的等级加载机制；</li>\n<li>将Class字节码重新解析成JVM统一要求的对象格式<h2 id=\"ClassLoader类结构分析\"><a href=\"#ClassLoader类结构分析\" class=\"headerlink\" title=\"ClassLoader类结构分析\"></a>ClassLoader类结构分析</h2><a id=\"more\"></a>\n<img src=\"http://i.imgur.com/R5tC01a.png\" alt=\"\"></li>\n</ol>\n<ul>\n<li><p>defineClass：可以将byte字节流解析成JVM能够识别的Class对象，这样我们也可以通过这个字节码直接创建Class对象形式的实例化对象</p>\n<p>  api中的介绍<br>  <img src=\"http://i.imgur.com/bFjiI1f.png\" alt=\"\"></p>\n</li>\n<li>findClass：使用指定的二进制名称查找类，此方法在ClassLoader的实现类中应该被重写，从而取得要加载类的字节码。该方法通常与defineClass一起使用，使用该方法加载字节码之后，然后调用defineClass方法生成类的Class对象。</li>\n<li>loadClass：使用指定的二进制名称来加载类，如果只想在运行时能够加载自己指定的一个类，则可以使用this.getClass().getClassLoader().loadClass(“classname”)获取这个类的class对象。<br><img src=\"http://i.imgur.com/zX6j3RL.png\" alt=\"\"></li>\n<li>resolveClass：链接指定的类。如果想在类被加载到JVM中时就被链接，则可以使用该方法</li>\n</ul>\n<p>查看源码可以发现ClassLoader是一个抽象类。如果要实现自己的ClassLoader，一般继承URLClassLoader。另外在ClassLoader中还有一些辅助方法：<br><img src=\"http://i.imgur.com/vKXgX4K.png\" alt=\"\"></p>\n<h2 id=\"ClassLoader的等级加载机制\"><a href=\"#ClassLoader的等级加载机制\" class=\"headerlink\" title=\"ClassLoader的等级加载机制\"></a>ClassLoader的等级加载机制</h2><p>整个JVM提供了三层    ClassLoader，可以分为两种类型。</p>\n<ol>\n<li>BootStrap ClassLoader：启动类加载器。该类仅仅是一个类记载工具，既没有更高一级的父加载器，也没有子加载器。该类加载器并不属于JVM的类等级层次，因为BootStrap ClassLoader并没有遵守ClassLoader的加载规则，所以该加载器并没有子类。</li>\n<li>ExtClassLoader：扩展类加载器。该类JVM自身的一部分，如果一个类既不是JVM内部的类，也不用户定义的类，将会由这个类来加载。加载System.getProperty(“java.ext.dirs”)所指定的路径或jar。打印主要加载目录</li>\n</ol>\n<p><img src=\"http://i.imgur.com/26dQrro.png\" alt=\"\"></p>\n<ol>\n<li>AppClassLoader：系统类加载器。它是ExtClassLoader的子类。加载System.getProperty(“java.class.path”)所指定的路径或jar，这个目录就是我们常用到的classpath。除了System.getProperty(“java.ext.dirs”)目录下的类由ExtClassLoader加载，其他类都由AppClassLoader加载。</li>\n</ol>\n<p>类加载器的等级结构图：</p>\n<p><img src=\"http://i.imgur.com/k8Ri1H5.png\" alt=\"\"></p>\n<p>ClassLoader的类层次结构，参考深入分析JavaWeb技术内幕</p>\n<p><img src=\"http://i.imgur.com/N7lLSTQ.png\" alt=\"\"></p>\n<h2 id=\"JVM加载Class文件\"><a href=\"#JVM加载Class文件\" class=\"headerlink\" title=\"JVM加载Class文件\"></a>JVM加载Class文件</h2><h3 id=\"加载方式\"><a href=\"#加载方式\" class=\"headerlink\" title=\"加载方式\"></a>加载方式</h3><p>JVM加载class文件到内存有两种方式：</p>\n<ul>\n<li>显示加载：在代码中通过ClassLoader来加载需要的类。<br>  显示加载类的方式通常有：<ul>\n<li>Class.forName();</li>\n<li>ClassLoader.loadClass();</li>\n<li>ClassLoader.findSystemClass();</li>\n</ul>\n</li>\n<li>隐式加载：JVM自动加载需要的类到内存。<h3 id=\"如何加载\"><a href=\"#如何加载\" class=\"headerlink\" title=\"如何加载\"></a>如何加载</h3>一般有三个阶段：</li>\n</ul>\n<ol>\n<li>将.class文件包含的字节码加载到内存中。</li>\n<li>字节码验证、Class类等数据结构的分析以及相应的内存分配和最后符号表的链接。</li>\n<li>类中静态属性和初始化赋值，以及静态块的执行。</li>\n</ol>\n<p><img src=\"http://i.imgur.com/8Q2U44B.png\" alt=\"\"></p>\n","tags":[{"name":"classloader","slug":"classloader","permalink":"http://www.wanqhblog.top/tags/classloader/"},{"name":"jvm","slug":"jvm","permalink":"http://www.wanqhblog.top/tags/jvm/"}]},{"title":"WebService之CXF","date":"2017-08-23T03:52:00.000Z","path":"2017/08/23/cxf/","content":"<h2 id=\"什么是CXF\"><a href=\"#什么是CXF\" class=\"headerlink\" title=\"什么是CXF\"></a>什么是CXF</h2><p>Apache CXF = Celtix + XFire，开始叫 Apache CeltiXfire，后来更名为 Apache CXF 了，以下简称为 CXF。CXF 继承了 Celtix 和 XFire 两大开源项目的精华，提供了对 JAX-WS 全面的支持，并且提供了多种 Binding 、DataBinding、Transport 以及各种 Format 的支持，并且可以根据实际项目的需要，采用代码优先（Code First）或者 WSDL 优先（WSDL First）来轻松地实现 Web Services 的发布和使用。Apache CXF已经是一个正式的Apache顶级项目。</p>\n<a id=\"more\"></a>\n<h2 id=\"CXF与Spring整合\"><a href=\"#CXF与Spring整合\" class=\"headerlink\" title=\"CXF与Spring整合\"></a>CXF与Spring整合</h2><h3 id=\"需求\"><a href=\"#需求\" class=\"headerlink\" title=\"需求\"></a>需求</h3><p>CXF与spring整合，实现手机号码归属地查询。所以这里我们需要调用公网的号码归属地查询。</p>\n<h3 id=\"导入公网的接口\"><a href=\"#导入公网的接口\" class=\"headerlink\" title=\"导入公网的接口\"></a>导入公网的接口</h3><p>公网地址：<a href=\"http://www.webxml.com.cn/zh_cn/index.aspx\" target=\"_blank\" rel=\"external\">http://www.webxml.com.cn/zh_cn/index.aspx</a><br>手机号码归属地查询WSDL：<a href=\"http://ws.webxml.com.cn/WebServices/MobileCodeWS.asmx?wsdl\" target=\"_blank\" rel=\"external\">http://ws.webxml.com.cn/WebServices/MobileCodeWS.asmx?wsdl</a></p>\n<p>在CMD中输入命令：wsimport -s . <a href=\"http://ws.webxml.com.cn/WebServices/MobileCodeWS.asmx?wsdl生成公网的调用代码，将代码复制到工程中\" target=\"_blank\" rel=\"external\">http://ws.webxml.com.cn/WebServices/MobileCodeWS.asmx?wsdl生成公网的调用代码，将代码复制到工程中</a></p>\n<h3 id=\"添加依赖\"><a href=\"#添加依赖\" class=\"headerlink\" title=\"添加依赖\"></a>添加依赖</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.cxf<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>cxf-rt-frontend-jaxws<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;cxf.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.cxf<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>cxf-rt-frontend-jaxrs<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;cxf.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.cxf<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>cxf-rt-transports-http<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;cxf.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.cxf<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>cxf<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;cxf.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-context<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-core<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-webmvc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"服务接口\"><a href=\"#服务接口\" class=\"headerlink\" title=\"服务接口\"></a>服务接口</h3><p>这里与jaxws不同的是只要在服务接口类上添加@WebService注解既可<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * 基于jaxws开发的SEI</span></div><div class=\"line\"><span class=\"comment\"> * 天气查询接口</span></div><div class=\"line\"><span class=\"comment\"> */</span></div><div class=\"line\"><span class=\"meta\">@WebService</span>(targetNamespace = <span class=\"string\">\"http://service.wqh.com\"</span>,</div><div class=\"line\">name = <span class=\"string\">\"PhoneQueryInterface\"</span>,</div><div class=\"line\">portName = <span class=\"string\">\"PhoneQueryInterfacePort\"</span>,</div><div class=\"line\">serviceName = <span class=\"string\">\"PhoneQueryInterfaceService\"</span>)</div><div class=\"line\"><span class=\"meta\">@BindingType</span>(javax.xml.ws.soap.SOAPBinding.SOAP12HTTP_BINDING)<span class=\"comment\">//发布soap1.2</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">PhoneQueryInterface</span> </span>&#123;</div><div class=\"line\">    <span class=\"function\">String <span class=\"title\">getMobileCodeInfo</span> <span class=\"params\">(String mobileCode)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"接口实现类\"><a href=\"#接口实现类\" class=\"headerlink\" title=\"接口实现类\"></a>接口实现类</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PhoneQueryInterfaceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">PhoneQueryInterface</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">/*公网的号码归属地查询对象*/</span></div><div class=\"line\">    <span class=\"keyword\">private</span> MobileCodeWSSoap mobileCodeWSSoap;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getMobileCodeInfo</span><span class=\"params\">(String mobileCode)</span> </span>&#123;</div><div class=\"line\">        String codeInfo = mobileCodeWSSoap.getMobileCodeInfo(mobileCode, <span class=\"keyword\">null</span>);</div><div class=\"line\">        <span class=\"keyword\">return</span> codeInfo;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> MobileCodeWSSoap <span class=\"title\">getMobileCodeWSSoap</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> mobileCodeWSSoap;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMobileCodeWSSoap</span><span class=\"params\">(MobileCodeWSSoap mobileCodeWSSoap)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.mobileCodeWSSoap = mobileCodeWSSoap;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"添加配置信息\"><a href=\"#添加配置信息\" class=\"headerlink\" title=\"添加配置信息\"></a>添加配置信息</h3><p>applicationContext.xml：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">&lt;!-- 配置发布webservice服务 --&gt;</div><div class=\"line\">&lt;jaxws:server address=<span class=\"string\">\"/mobil\"</span> serviceClass=<span class=\"string\">\"com.wqh.cxf.service.PhoneQueryInterface\"</span>&gt;</div><div class=\"line\">    &lt;jaxws:serviceBean&gt;</div><div class=\"line\">        &lt;ref bean=\"phoneQuery\"&gt;&lt;/ref&gt;</div><div class=\"line\">    &lt;/jaxws:serviceBean&gt;</div><div class=\"line\">&lt;/jaxws:server&gt;</div><div class=\"line\">&lt;!--</div><div class=\"line\">配置公网号码归属地查询的客户端</div><div class=\"line\">address：公网归属地的地址</div><div class=\"line\">--&gt;</div><div class=\"line\">&lt;jaxws:client id=<span class=\"string\">\"mobileCodeWSSoap\"</span> serviceClass=<span class=\"string\">\"cn.com.webxml.MobileCodeWSSoap\"</span></div><div class=\"line\">              address=<span class=\"string\">\"http://ws.webxml.com.cn/WebServices/MobileCodeWS.asmx\"</span>/&gt;</div><div class=\"line\">&lt;!--归属地查询的bean--&gt;</div><div class=\"line\">&lt;bean id=<span class=\"string\">\"phoneQuery\"</span> <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.cxf.service.PhoneQueryInterfaceImpl\"</span>&gt;</div><div class=\"line\">    &lt;property name=<span class=\"string\">\"mobileCodeWSSoap\"</span> ref=<span class=\"string\">\"mobileCodeWSSoap\"</span>&gt;</div><div class=\"line\">    &lt;/property&gt;</div><div class=\"line\">&lt;/bean&gt;</div></pre></td></tr></table></figure>\n<p>web.xml</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!-- 加载spring容器 --&gt;</div><div class=\"line\">&lt;context-param&gt;</div><div class=\"line\">    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</div><div class=\"line\">    &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;</div><div class=\"line\">&lt;/context-param&gt;</div><div class=\"line\">&lt;listener&gt;</div><div class=\"line\">    &lt;listener-<span class=\"class\"><span class=\"keyword\">class</span>&gt;<span class=\"title\">org</span>.<span class=\"title\">springframework</span>.<span class=\"title\">web</span>.<span class=\"title\">context</span>.<span class=\"title\">ContextLoaderListener</span>&lt;/<span class=\"title\">listener</span>-<span class=\"title\">class</span>&gt;</span></div><div class=\"line\"><span class=\"class\">&lt;/<span class=\"title\">listener</span>&gt;</span></div><div class=\"line\"><span class=\"class\">&lt;<span class=\"title\">servlet</span>&gt;</span></div><div class=\"line\"><span class=\"class\">    &lt;<span class=\"title\">description</span>&gt;<span class=\"title\">Apache</span> <span class=\"title\">CXF</span> <span class=\"title\">Endpoint</span>&lt;/<span class=\"title\">description</span>&gt;</span></div><div class=\"line\"><span class=\"class\">    &lt;<span class=\"title\">display</span>-<span class=\"title\">name</span>&gt;<span class=\"title\">cxf</span>&lt;/<span class=\"title\">display</span>-<span class=\"title\">name</span>&gt;</span></div><div class=\"line\"><span class=\"class\">    &lt;<span class=\"title\">servlet</span>-<span class=\"title\">name</span>&gt;<span class=\"title\">cxf</span>&lt;/<span class=\"title\">servlet</span>-<span class=\"title\">name</span>&gt;</span></div><div class=\"line\"><span class=\"class\">    &lt;<span class=\"title\">servlet</span>-<span class=\"title\">class</span>&gt;<span class=\"title\">org</span>.<span class=\"title\">apache</span>.<span class=\"title\">cxf</span>.<span class=\"title\">transport</span>.<span class=\"title\">servlet</span>.<span class=\"title\">CXFServlet</span>&lt;/<span class=\"title\">servlet</span>-<span class=\"title\">class</span>&gt;</span></div><div class=\"line\"><span class=\"class\">    &lt;<span class=\"title\">load</span>-<span class=\"title\">on</span>-<span class=\"title\">startup</span>&gt;1&lt;/<span class=\"title\">load</span>-<span class=\"title\">on</span>-<span class=\"title\">startup</span>&gt;</span></div><div class=\"line\"><span class=\"class\">&lt;/<span class=\"title\">servlet</span>&gt;</span></div><div class=\"line\"><span class=\"class\">&lt;<span class=\"title\">servlet</span>-<span class=\"title\">mapping</span>&gt;</span></div><div class=\"line\"><span class=\"class\">    &lt;<span class=\"title\">servlet</span>-<span class=\"title\">name</span>&gt;<span class=\"title\">cxf</span>&lt;/<span class=\"title\">servlet</span>-<span class=\"title\">name</span>&gt;</span></div><div class=\"line\"><span class=\"class\">    &lt;<span class=\"title\">url</span>-<span class=\"title\">pattern</span>&gt;/<span class=\"title\">ws</span>/*&lt;/<span class=\"title\">url</span>-<span class=\"title\">pattern</span>&gt;</span></div><div class=\"line\"><span class=\"class\">&lt;/<span class=\"title\">servlet</span>-<span class=\"title\">mapping</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>启动服务器</p>\n<h3 id=\"查看wsdl\"><a href=\"#查看wsdl\" class=\"headerlink\" title=\"查看wsdl\"></a>查看wsdl</h3><p>在浏览器地址栏输入：<br><a href=\"http://127.0.0.1:8080/｛项目名｝/ws/mobil?wsdl\" target=\"_blank\" rel=\"external\">http://127.0.0.1:8080/｛项目名｝/ws/mobil?wsdl</a></p>\n<h3 id=\"编写客户端\"><a href=\"#编写客户端\" class=\"headerlink\" title=\"编写客户端\"></a>编写客户端</h3><p>这里客户端可以使用前面介绍的wsimiport命令，也可以使用wsdl2java命令。如果使用wsdl2java命令需要在系统中添加cxf的环境变量。</p>\n<p>下载CXF <a href=\"http://cxf.apache.org/download.html\" target=\"_blank\" rel=\"external\">http://cxf.apache.org/download.html</a></p>\n<p>解压下载的文件，将bin目录添加到环境变量中。<br>然后使用命令：wsdl2java –d . –frontend jaxws21 <a href=\"http://127.0.0.1:8080/｛项目名｝/ws/mobil?wsdl\" target=\"_blank\" rel=\"external\">http://127.0.0.1:8080/｛项目名｝/ws/mobil?wsdl</a></p>\n<p>注意：这里加上了–frontend jaxws21。原因是因为：cxf需要JAX-WS API 2.2而jdk6的jax-ws是2.1 版本，需要wsdl2java 使用“-frontend jaxws21”</p>\n<p>代码与jaxws方式一样</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//创建服务视图</span></div><div class=\"line\">PhoneQueryInterfaceService phoneQueryInterfaceService = <span class=\"keyword\">new</span> PhoneQueryInterfaceService();</div><div class=\"line\"><span class=\"comment\">//通过服务视图得到服务端点</span></div><div class=\"line\">PhoneQueryInterface phoneQueryInterfaceServicePort = phoneQueryInterfaceService.getPort(PhoneQueryInterface.class);</div><div class=\"line\"><span class=\"comment\">//调用webservice服务方法</span></div><div class=\"line\">String result1 = phoneQueryInterfaceServicePort.getMobileCodeInfo(<span class=\"string\">\"号码\"</span>);</div><div class=\"line\">System.out.println(result1);</div></pre></td></tr></table></figure>\n<h2 id=\"CXF实现rest服务\"><a href=\"#CXF实现rest服务\" class=\"headerlink\" title=\"CXF实现rest服务\"></a>CXF实现rest服务</h2><h3 id=\"什么是rest服务\"><a href=\"#什么是rest服务\" class=\"headerlink\" title=\"什么是rest服务\"></a>什么是rest服务</h3><p>REST 是一种软件架构模式，只是一种风格，rest服务采用HTTP 做传输协议，REST 对于HTTP 的利用分为以下两种：资源定位和资源操作。</p>\n<ul>\n<li><p>资源定位：</p>\n<blockquote>\n<p>Rest要求对资源定位更加准确，如下：<br>非rest方式：<a href=\"http://ip:port/queryUser.action?userType=student&amp;id=001\" target=\"_blank\" rel=\"external\">http://ip:port/queryUser.action?userType=student&amp;id=001</a><br>Rest方式：<a href=\"http://ip:port/user/student/001\" target=\"_blank\" rel=\"external\">http://ip:port/user/student/001</a><br>Rest方式表示互联网上的资源更加准确，但是也有缺点，可能目录的层级较多不容易理解。</p>\n</blockquote>\n</li>\n<li><p>资源操作：</p>\n<blockquote>\n<p>利用HTTP 的GET、POST、PUT、DELETE 四种操作来表示数据库操作的SELECT、UPDATE、INSERT、DELETE 操作。<br>比如：<br>查询学生方法：<br>设置Http的请求方法为GET，url如下：<a href=\"http://ip:port/user/student/001\" target=\"_blank\" rel=\"external\">http://ip:port/user/student/001</a><br>添加学生方法：<br>设置http的请求方法为PUT，url如下：<a href=\"http://ip:port/user/student/001/张三/\" target=\"_blank\" rel=\"external\">http://ip:port/user/student/001/张三/</a>……</p>\n</blockquote>\n</li>\n</ul>\n<p>Rest常用于资源定位，资源操作方式较少使用。</p>\n<p>REST 是一种软件架构理念，现在被移植到Web 服务上，那么在开发Web 服务上，偏于面向资源的服务适用于REST，REST 简单易用，效率高，SOAP 成熟度较高，安全性较好。<br>注意：REST 不等于WebService，JAX-RS 只是将REST 设计风格应用到Web 服务开发上。<br>参考：<a href=\"http://www.ruanyifeng.com/blog/2011/09/restful\" title=\"理解RESTful架构\" target=\"_blank\" rel=\"external\">理解RESTful架构</a></p>\n<h3 id=\"rest服务发布\"><a href=\"#rest服务发布\" class=\"headerlink\" title=\"rest服务发布\"></a>rest服务发布</h3><h4 id=\"需求-1\"><a href=\"#需求-1\" class=\"headerlink\" title=\"需求\"></a>需求</h4><p>发布查询学生信息的服务，返回的数据格式为json和xml</p>\n<h4 id=\"服务接口-1\"><a href=\"#服务接口-1\" class=\"headerlink\" title=\"服务接口\"></a>服务接口</h4><p>pojo：在pojo类上使用@XmlRootElement注解，是该类对象可以装换成xml<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@XmlRootElement</span>(name = <span class=\"string\">\"student\"</span>)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">long</span> id;</div><div class=\"line\">\t<span class=\"keyword\">private</span> String name;</div><div class=\"line\">\t<span class=\"keyword\">private</span> Date birthday;</div><div class=\"line\">\t<span class=\"comment\">//getset</span></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>服务类接口：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@WebService</span></div><div class=\"line\"><span class=\"meta\">@Path</span>(<span class=\"string\">\"/student\"</span>)</div><div class=\"line\"><span class=\"meta\">@BindingType</span>(javax.xml.ws.soap.SOAPBinding.SOAP12HTTP_BINDING)<span class=\"comment\">//发布soap1.2</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">StudentService</span> </span>&#123;</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"comment\">//查询学生信息</span></div><div class=\"line\">\t<span class=\"meta\">@GET</span> <span class=\"comment\">//http的get方法</span></div><div class=\"line\">\t<span class=\"meta\">@Path</span>(<span class=\"string\">\"/query/&#123;id&#125;\"</span>)<span class=\"comment\">//id参数通过url传递</span></div><div class=\"line\">\t<span class=\"meta\">@Produces</span>(MediaType.APPLICATION_XML)<span class=\"comment\">//设置媒体类型xml格式</span></div><div class=\"line\">    <span class=\"function\">Student <span class=\"title\">queryStudent</span><span class=\"params\">(@PathParam(<span class=\"string\">\"id\"</span>)</span><span class=\"keyword\">long</span> id)</span>;</div><div class=\"line\">\t</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"comment\">//查询学生列表</span></div><div class=\"line\">\t<span class=\"meta\">@GET</span> <span class=\"comment\">//http的get方法</span></div><div class=\"line\">\t<span class=\"meta\">@Path</span>(<span class=\"string\">\"/querylist/&#123;type&#125;\"</span>)</div><div class=\"line\">\t<span class=\"meta\">@Produces</span>(&#123;<span class=\"string\">\"application/json;charset=utf-8\"</span>,MediaType.APPLICATION_XML&#125;)<span class=\"comment\">//设置媒体类型xml格式和json格式</span></div><div class=\"line\">\t<span class=\"comment\">//如果想让rest返回xml需要在rest的url后边添加?_type=xml，默认为xml</span></div><div class=\"line\">\t<span class=\"comment\">//如果想让rest返回json需要在rest的url后边添加?_type=json</span></div><div class=\"line\">\t<span class=\"function\">List&lt;Student&gt; <span class=\"title\">queryStudentList</span><span class=\"params\">(@PathParam(<span class=\"string\">\"type\"</span>)</span> String type)</span>;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>接口实现类：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StudentServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">StudentService</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> Student <span class=\"title\">queryStudent</span><span class=\"params\">(<span class=\"keyword\">long</span> id)</span> </span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">// 使用静态数据</span></div><div class=\"line\">\t\tStudent student = <span class=\"keyword\">new</span> Student();</div><div class=\"line\">\t\tstudent.setId(id);</div><div class=\"line\">\t\tstudent.setName(<span class=\"string\">\"张三\"</span>);</div><div class=\"line\">\t\tstudent.setBirthday(<span class=\"keyword\">new</span> Date());</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> student;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"meta\">@Override</span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> List&lt;Student&gt; <span class=\"title\">queryStudentList</span><span class=\"params\">(String type)</span> </span>&#123;</div><div class=\"line\">\t\tList&lt;Student&gt; list = <span class=\"keyword\">new</span> ArrayList&lt;Student&gt;();</div><div class=\"line\">\t\tStudent student1 = <span class=\"keyword\">new</span> Student();</div><div class=\"line\">\t\tstudent1.setId(<span class=\"number\">1234</span>);</div><div class=\"line\">\t\tstudent1.setName(<span class=\"string\">\"张三\"</span>);</div><div class=\"line\">\t\tstudent1.setBirthday(<span class=\"keyword\">new</span> Date());</div><div class=\"line\">        </div><div class=\"line\">\t\tStudent student2 = <span class=\"keyword\">new</span> Student();</div><div class=\"line\">        student2.setId(<span class=\"number\">2345</span>);</div><div class=\"line\">        student2.setName(<span class=\"string\">\"李四\"</span>);</div><div class=\"line\">        student2.setBirthday(<span class=\"keyword\">new</span> Date());</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">        Student student3 = <span class=\"keyword\">new</span> Student();</div><div class=\"line\">        student3.setId(<span class=\"number\">3456</span>);</div><div class=\"line\">        student3.setName(<span class=\"string\">\"王五\"</span>);</div><div class=\"line\">        student3.setBirthday(<span class=\"keyword\">new</span> Date());</div><div class=\"line\"></div><div class=\"line\">        list.add(student1);</div><div class=\"line\">\t\tlist.add(student2);</div><div class=\"line\">\t\tlist.add(student3);</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> list;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"发布服务\"><a href=\"#发布服务\" class=\"headerlink\" title=\"发布服务\"></a>发布服务</h4><p>1、使用java代码发布，如果直接使用程序发布，需要导入cxf.jaxrsde<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//使用jaxrsServerFactoryBean发布rest服务</span></div><div class=\"line\">JAXRSServerFactoryBean jaxrsServerFactoryBean = <span class=\"keyword\">new</span> JAXRSServerFactoryBean();</div><div class=\"line\"><span class=\"comment\">//设置rest的服务地址</span></div><div class=\"line\">jaxrsServerFactoryBean.setAddress(<span class=\"string\">\"http://127.0.0.1:12345/rest\"</span>);</div><div class=\"line\"><span class=\"comment\">//设置服务对象</span></div><div class=\"line\">jaxrsServerFactoryBean.setServiceBean(<span class=\"keyword\">new</span> StudentServiceImpl());</div><div class=\"line\"><span class=\"comment\">//设置资源 对象，如果有多个pojo资源 对象中间以半角逗号隔开</span></div><div class=\"line\">jaxrsServerFactoryBean.setResourceClasses(StudentServiceImpl.class);</div><div class=\"line\"><span class=\"comment\">//发布rest服务</span></div><div class=\"line\">jaxrsServerFactoryBean.create();</div></pre></td></tr></table></figure></p>\n<p>2、整合spring发布，在applicationContext.xml中配置<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;!-- service --&gt;</div><div class=\"line\">&lt;bean id=<span class=\"string\">\"studentService\"</span> <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"com.wqh.ws.cxf.rest.service.StudentServiceImpl\"</span>/&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;!-- 发布rest服务</div><div class=\"line\">使用jaxws:server和jaxws:endpoint可以发布服务</div><div class=\"line\">webservice地址=tomcat地址+cxf servlet的路径+/rest</div><div class=\"line\"></div><div class=\"line\">这里与之前不同的是，不需要添加serviceClass</div><div class=\"line\"> --&gt;</div><div class=\"line\">&lt;jaxrs:server address=<span class=\"string\">\"/rest\"</span>&gt;</div><div class=\"line\">\t&lt;jaxrs:serviceBeans&gt;</div><div class=\"line\">\t   &lt;ref bean=<span class=\"string\">\"studentService\"</span>/&gt;</div><div class=\"line\">\t&lt;/jaxrs:serviceBeans&gt;</div><div class=\"line\">&lt;/jaxrs:server&gt;</div></pre></td></tr></table></figure></p>\n<p>这里rest服务是生成wadl说明文档，查看wadl在地址栏输入：<a href=\"http://localhost:8080/webcxf/ws/rest?_wadl\" target=\"_blank\" rel=\"external\">http://localhost:8080/webcxf/ws/rest?_wadl</a><br><img src=\"http://i.imgur.com/JOt5ubZ.png\" alt=\"\"><br>这里能看到一些发布的信息，然后在地址栏中请求发布的服务：<br><a href=\"http://localhost:8080/webcxf/ws/rest/student/query/1323\" target=\"_blank\" rel=\"external\">http://localhost:8080/webcxf/ws/rest/student/query/1323</a></p>\n<p><img src=\"http://i.imgur.com/tLQzzPQ.png\" alt=\"\"></p>\n<p>查看json格式数据：_type指定要返回的数据格式<br><a href=\"http://localhost:8080/webcxf/ws/rest/student/querylist/1323?_type=json\" target=\"_blank\" rel=\"external\">http://localhost:8080/webcxf/ws/rest/student/querylist/1323?_type=json</a></p>\n<p><img src=\"http://i.imgur.com/HGBkyCK.png\" alt=\"\"></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>WebService是一个平台独立的，低耦合的，自包含的、基于可编程的web的应用程序。WebService的发也有很多种方式，比如常见的jax-ws和CXF。对于jax-ws开发，感觉比较简单与方便，不需要添加太多的jar依赖；但是有一定的局限性。而对于CXF，jar包依赖太过复杂，使用maven添加需要更加注意。</p>\n","tags":[{"name":"webservice","slug":"webservice","permalink":"http://www.wanqhblog.top/tags/webservice/"}]},{"title":"WebService知识点","date":"2017-08-21T06:47:38.000Z","path":"2017/08/21/webservice2/","content":"<h2 id=\"三要素\"><a href=\"#三要素\" class=\"headerlink\" title=\"三要素\"></a>三要素</h2><h3 id=\"SOAP\"><a href=\"#SOAP\" class=\"headerlink\" title=\"SOAP\"></a>SOAP</h3><p>SOAP:简单对象访问协议（Simple Object Access Protocal），是一种简单的基于 XML 的协议，它使应用程序通过 HTTP 来交换信息，简单理解为soap=http+xml。Soap协议版本主要使用soap1.1、soap1.2<a id=\"more\"></a></p>\n<h4 id=\"SOAP是什么\"><a href=\"#SOAP是什么\" class=\"headerlink\" title=\"SOAP是什么\"></a>SOAP是什么</h4><ul>\n<li>SOAP 是一种网络通信协议</li>\n<li>SOAP即Simple Object Access Protocol简易对象访问协议</li>\n<li>SOAP 用于跨平台应用程序之间的通信</li>\n<li>SOAP 被设计用来通过因特网(http)进行通信</li>\n<li>SOAP ＝ HTTP+XML，其实就是通过HTTP发xml数据</li>\n<li>SOAP 很简单并可扩展支持面向对象</li>\n<li>SOAP 允许您跨越防火墙</li>\n<li>SOAP 将被作为 W3C 标准来发展</li>\n</ul>\n<h4 id=\"SOAP语法格式\"><a href=\"#SOAP语法格式\" class=\"headerlink\" title=\"SOAP语法格式\"></a>SOAP语法格式</h4><h5 id=\"构建模块\"><a href=\"#构建模块\" class=\"headerlink\" title=\"构建模块\"></a>构建模块</h5><ul>\n<li>必需的Envelope 元素，此元素将整个 XML 文档标识为一条 SOAP 消息</li>\n<li>可选的Header 元素，包含头部信息</li>\n<li>必需的Body 元素，包含所有的调用和响应信息 </li>\n<li>可选的 Fault 元素，提供有关在处理此消息所发生错误的信息</li>\n</ul>\n<h5 id=\"语法规则\"><a href=\"#语法规则\" class=\"headerlink\" title=\"语法规则\"></a>语法规则</h5><ul>\n<li>SOAP 消息必须用 XML 来编码</li>\n<li>SOAP 消息必须使用 SOAP Envelope 命名空间</li>\n<li>SOAP 消息必须使用 SOAP Encoding 命名空间</li>\n<li>SOAP 消息不能包含 DTD 引用</li>\n<li>SOAP 消息不能包含 XML 处理指令</li>\n</ul>\n<h5 id=\"基本结构\"><a href=\"#基本结构\" class=\"headerlink\" title=\"基本结构\"></a>基本结构</h5><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span>?&gt;</div><div class=\"line\">&lt;soap:Envelope</div><div class=\"line\">xmlns:soap=<span class=\"string\">\"http://www.w3.org/2001/12/soap-envelope\"</span></div><div class=\"line\">soap:encodingStyle=<span class=\"string\">\"http://www.w3.org/2001/12/soap-encoding\"</span>&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;soap:Header&gt;</div><div class=\"line\">...</div><div class=\"line\">&lt;/soap:Header&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;soap:Body&gt;</div><div class=\"line\">...</div><div class=\"line\">  &lt;soap:Fault&gt;</div><div class=\"line\">  ...</div><div class=\"line\">  &lt;/soap:Fault&gt;</div><div class=\"line\">&lt;/soap:Body&gt;</div><div class=\"line\"></div><div class=\"line\">&lt;/soap:Envelope&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"WSDL\"><a href=\"#WSDL\" class=\"headerlink\" title=\"WSDL\"></a>WSDL</h3><p>WSDL 是基于 XML 的用于描述Web Service及其函数、参数和返回值。通俗理解Wsdl是webservice的使用说明书。</p>\n<h4 id=\"wsdl是什么\"><a href=\"#wsdl是什么\" class=\"headerlink\" title=\"wsdl是什么\"></a>wsdl是什么</h4><ul>\n<li>WSDL 指网络服务描述语言(Web Services Description Language)。</li>\n<li>WSDL是一种使用 XML 编写的文档。这种文档可描述某个 Web service。它可规定服务的位置，以及此服务提供的操作（或方法）。</li>\n<li>WSDL 是一种 XML 文档</li>\n<li>WSDL 用于描述网络服务</li>\n<li>WSDL 也可用于定位网络服务</li>\n</ul>\n<h4 id=\"wsdl结构\"><a href=\"#wsdl结构\" class=\"headerlink\" title=\"wsdl结构\"></a>wsdl结构</h4><ol>\n<li><code>&lt;service&gt;</code>    服务视图，webservice的服务结点，它包括了服务端点</li>\n<li><code>&lt;binding&gt;</code>     为每个服务端点定义消息格式和协议细节</li>\n<li><code>&lt;portType&gt;</code>   服务端点，描述 web service可被执行的操作方法，以及相关的消息，通过binding指向portType</li>\n<li><code>&lt;message&gt;</code>  定义一个操作（方法）的数据参数(可有多个参数)</li>\n<li><code>&lt;types&gt;</code>       定义 web service 使用的全部数据类型</li>\n</ol>\n<h4 id=\"wsdl说明书阅读\"><a href=\"#wsdl说明书阅读\" class=\"headerlink\" title=\"wsdl说明书阅读\"></a>wsdl说明书阅读</h4><p>从下往上读，先找到服务视图，通过binging找到protType，找到了protType就找到了我们要调用的webservice方法。<br><img src=\"http://i.imgur.com/Oy0c8Ll.png\" alt=\"\"></p>\n<h3 id=\"UDDI\"><a href=\"#UDDI\" class=\"headerlink\" title=\"UDDI\"></a>UDDI</h3><p>UDDI 是一种目录服务，企业可以使用它对 Web services 进行注册和搜索。<br>UDDI，英文为 “Universal Description, Discovery and Integration”，可译为”通用描述、发现与集成服务”。</p>\n<p>UDDI 是一个独立于平台的框架，用于通过使用 Internet 来描述服务，发现企业，并对企业服务进行集成。</p>\n<ul>\n<li>UDDI 指的是通用描述、发现与集成服务</li>\n<li>UDDI 是一种用于存储有关 web services 的信息的目录。</li>\n<li>UDDI 是一种由 WSDL 描述的 web services 界面的目录。</li>\n<li>UDDI 经由 SOAP 进行通信</li>\n<li>UDDI 被构建入了微软的 .NET 平台</li>\n</ul>\n<h2 id=\"常用注解\"><a href=\"#常用注解\" class=\"headerlink\" title=\"常用注解\"></a>常用注解</h2><h3 id=\"WebService\"><a href=\"#WebService\" class=\"headerlink\" title=\"@WebService\"></a>@WebService</h3><p>@WebService-定义服务，在public class上边，可选参数：</p>\n<ul>\n<li>targetNamespace：指定命名空间</li>\n<li>name：portType的名称</li>\n<li>portName：port的名称</li>\n<li>serviceName：服务名称</li>\n<li>endpointInterface：SEI接口地址，如果一个服务类实现了多个接口，只需要发布一个接口的方法，可通过此注解指定要发布服务的接口。</li>\n</ul>\n<h3 id=\"WebMethod\"><a href=\"#WebMethod\" class=\"headerlink\" title=\"@WebMethod\"></a>@WebMethod</h3><p>@WebMethod-定义方法，在公开方法上边，可选参数：</p>\n<ul>\n<li>operationName：方法名</li>\n<li>exclude：设置为true表示此方法不是webservice方法，反之则表示webservice方法</li>\n<li>action：此操作的动作。 对于 SOAP 绑定，此方法可确定 soap 动作的值。 </li>\n</ul>\n<h3 id=\"WebResult\"><a href=\"#WebResult\" class=\"headerlink\" title=\"@WebResult\"></a>@WebResult</h3><p>@WebResult-定义返回值，在方法返回值前边，可选参数:</p>\n<ul>\n<li>name：返回结果值的名称</li>\n<li>partName：表示此返回值的 wsdl:part 的名称。此名称只在操作是 rpc 样式，或者操作是文档样式且参数样式为 BARE 时使用。 </li>\n<li>targetNamespace：返回值的 XML 名称空间。只在操作是文档样式或者返回值映射到某一个头时使用。如果目标名称空间被设置为 “”，则此名称空间表示空名称空间。</li>\n<li>header：如果为 true，则结果是从消息头而不是消息正文获取的。 </li>\n</ul>\n<h3 id=\"WebParam\"><a href=\"#WebParam\" class=\"headerlink\" title=\"@WebParam\"></a>@WebParam</h3><p>@WebParam-定义参数，在方法参数前边，可选参数：</p>\n<ul>\n<li>name：指定参数的名称</li>\n<li>partName：表示此返回值的 wsdl:part 的名称。此名称只在操作是 rpc 样式，或者操作是文档样式且参数样式为 BARE 时使用。 </li>\n<li>targetNamespace：返回值的 XML 名称空间。只在操作是文档样式或者返回值映射到某一个头时使用。如果目标名称空间被设置为 “”，则此名称空间表示空名称空间。</li>\n<li>header：如果为 true，则结果是从消息头而不是消息正文获取的。 </li>\n<li>mode：参数的流向（IN、OUT 或 INOUT 之一）。OUT 和 INOUT 模式只是为那些符合 Holder 类型定义（JAX-WS 2.0 [5] 的第 2.3.3 节）的参数类型所指定的。Holder 类型的参数必须为 OUT 或 INOUT。 </li>\n</ul>\n","tags":[{"name":"webservice","slug":"webservice","permalink":"http://www.wanqhblog.top/tags/webservice/"}]},{"title":"WebService入门介绍","date":"2017-08-21T03:12:38.000Z","path":"2017/08/21/webservice1/","content":"<h2 id=\"什么是WebService\"><a href=\"#什么是WebService\" class=\"headerlink\" title=\"什么是WebService\"></a>什么是WebService</h2><ul>\n<li>Web service 即web服务，它是一种跨编程语言和跨操作系统平台的远程调用技术即跨平台远程调用技术。</li>\n<li>采用标准SOAP(Simple Object Access Protocol)  协议传输，soap属于w3c标准。Soap协议是基于http的应用层协议，soap协议传输是xml数据。<a id=\"more\"></a></li>\n<li>采用wsdl作为描述语言即webservice使用说明书，wsdl属w3c标准。</li>\n<li>xml是webservice的跨平台的基础，XML主要的优点在于它既与平台无关，又与厂商无关。</li>\n<li>XSD，W3C为webservice制定了一套传输数据类型，使用xml进行描述，即XSD(XML Schema Datatypes)，任何编程语言写的webservice接口在发送数据时都要转换成webservice标准的XSD发送。</li>\n<li>当前非SOAP协议的webService以轻量为首要目标，比如rest webservice也是webservice的一种方式。</li>\n</ul>\n<h2 id=\"WebService规范简单介绍\"><a href=\"#WebService规范简单介绍\" class=\"headerlink\" title=\"WebService规范简单介绍\"></a>WebService规范简单介绍</h2><p>在java中，共有三种webservice规范：JAX-WS（JAX-RPC）、JAXM&amp;SAAJ、JAX-RS。</p>\n<h3 id=\"JAX-WS（JAX-RPC）\"><a href=\"#JAX-WS（JAX-RPC）\" class=\"headerlink\" title=\"JAX-WS（JAX-RPC）\"></a>JAX-WS（JAX-RPC）</h3><blockquote>\n<p>JAX-WS  的全称为 Java API for XML-Based Webservices ，JAX-WS允许开发者可以选择RPC-oriented或者message-oriented 来实现自己的web services。早期的基于SOAP 的JAVA 的Web 服务规范JAX-RPC（Java API For XML-Remote Procedure Call）目前已经被JAX-WS 规范取代。从java5开始支持JAX-WS2.0版本，Jdk1.6.0_13以后的版本支持2.1版本，jdk1.7支持2.2版本。</p>\n</blockquote>\n<h3 id=\"JAXM-amp-SAAJ\"><a href=\"#JAXM-amp-SAAJ\" class=\"headerlink\" title=\"JAXM&amp;SAAJ\"></a>JAXM&amp;SAAJ</h3><blockquote>\n<p>JAXM（JAVA API For XML Message）主要定义了包含了发送和接收消息所需的API，SAAJ（SOAP With Attachment API For Java，JSR 67）是与JAXM 搭配使用的API，为构建SOAP 包和解析SOAP 包提供了重要的支持，支持附件传输等，JAXM&amp;SAAJ 与JAX-WS 都是基于SOAP 的Web 服务，相比之下JAXM&amp;SAAJ 暴漏了SOAP更多的底层细节，编码比较麻烦，而JAX-WS 更加抽象，隐藏了更多的细节，更加面向对象，实现起来你基本上不需要关心SOAP 的任何细节</p>\n</blockquote>\n<h3 id=\"JAX-RS\"><a href=\"#JAX-RS\" class=\"headerlink\" title=\"JAX-RS\"></a>JAX-RS</h3><blockquote>\n<p>JAX-RS是JAVA EE6 引入的一个新技术。 JAX-RS即Java API for RESTful Web Services，是一个Java 编程语言的应用程序接口，支持按照表述性状态转移（REST）架构风格创建Web服务。JAX-RS使用了Java SE5引入的Java注解来简化Web服务的客户端和服务端的开发和部署。</p>\n</blockquote>\n<h2 id=\"使用JAX-WS开发WebService入门实例\"><a href=\"#使用JAX-WS开发WebService入门实例\" class=\"headerlink\" title=\"使用JAX-WS开发WebService入门实例\"></a>使用JAX-WS开发WebService入门实例</h2><h3 id=\"服务端发开发\"><a href=\"#服务端发开发\" class=\"headerlink\" title=\"服务端发开发\"></a>服务端发开发</h3><p>编写SEI(Service Endpoint Interface)，在WebService中称为portType,在java中为接口</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\"> * 基于jaxws开发的SEI</span></div><div class=\"line\"><span class=\"comment\"> * 天气查询接口</span></div><div class=\"line\"><span class=\"comment\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">WeatherInterface</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">/*根据城市查询天气*/</span></div><div class=\"line\">    <span class=\"function\">String <span class=\"title\">queryWeather</span><span class=\"params\">(String cityName)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>接口实现类，也就是WebService的服务类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/*使用注解标注为WebService的服务类*/</span></div><div class=\"line\"><span class=\"meta\">@WebService</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WeatherInterfaceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">WeatherInterface</span></span>&#123;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">queryWeather</span><span class=\"params\">(String cityName)</span> </span>&#123;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"客户端要查询的城市===\"</span>+cityName);</div><div class=\"line\">        String result = <span class=\"string\">\"多云\"</span>;</div><div class=\"line\">        System.out.println(<span class=\"string\">\"像客户端返回查询结果\"</span>+result);</div><div class=\"line\">        <span class=\"keyword\">return</span> result;</div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] srgs)</span></span>&#123;</div><div class=\"line\">        <span class=\"comment\">/*</span></div><div class=\"line\"><span class=\"comment\">        发布天气查询服务</span></div><div class=\"line\"><span class=\"comment\">        第一个参数：WebService的地址</span></div><div class=\"line\"><span class=\"comment\">        第二个参数：使用了@WebService标注的类</span></div><div class=\"line\"><span class=\"comment\">        */</span></div><div class=\"line\">        Endpoint.publish(<span class=\"string\">\"http://127.0.0.1:1234/webther\"</span>,<span class=\"keyword\">new</span> WeatherInterfaceImpl());</div><div class=\"line\"></div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>注：SEI的实现类中至少要有一个非静态的公开方法作为WebService的服务方法。在类上需要使用注解@WebService</p>\n<h3 id=\"查看wsdl\"><a href=\"#查看wsdl\" class=\"headerlink\" title=\"查看wsdl\"></a>查看wsdl</h3><ol>\n<li>在浏览器地址栏输入地址：<a href=\"http://127.0.0.1:1234/webther?wsdl\" target=\"_blank\" rel=\"external\">http://127.0.0.1:1234/webther?wsdl</a></li>\n<li>Wsdl不是webService,只是获取一个用于描述WebService的说明文件</li>\n<li>wsdl- WebServiceDescriptionLanguage,是以XML文件形式来描述WebService的”说明书”,有了说明书,我们才可以知道如何使用或是调用这个服务.<h3 id=\"使用Wsimport生成客户端调用代码\"><a href=\"#使用Wsimport生成客户端调用代码\" class=\"headerlink\" title=\"使用Wsimport生成客户端调用代码\"></a>使用Wsimport生成客户端调用代码</h3><h4 id=\"Wsimport介绍\"><a href=\"#Wsimport介绍\" class=\"headerlink\" title=\"Wsimport介绍\"></a>Wsimport介绍</h4><blockquote>\n<p>wsimport是jdk自带的webservice客户端工具,可以根据wsdl文档生成客户端调用代码(java代码).当然,无论服务器端的WebService是用什么语言写的,都可以生成调用webservice的客户端代码，服务端通过客户端代码调用webservice。<br>wsimport.exe位于JAVA_HOME\\bin目录下.</p>\n</blockquote>\n</li>\n</ol>\n<p>常用参数为:</p>\n<ul>\n<li>-d&lt;目录&gt;  - 将生成.class文件。默认参数。</li>\n<li>-s&lt;目录&gt; - 将生成.java文件。</li>\n<li>-p&lt;生成的新包名&gt; -将生成的类，放于指定的包下。<br>(wsdlurl) - <a href=\"http://server:port/service?wsdl，必须的参数。\" target=\"_blank\" rel=\"external\">http://server:port/service?wsdl，必须的参数。</a></li>\n</ul>\n<p>示例： C:/&gt; wsimport –s . <a href=\"http://127.0.0.1:1234/weather?wsdl\" target=\"_blank\" rel=\"external\">http://127.0.0.1:1234/weather?wsdl</a> </p>\n<p>注意：-s不能分开，-s后面有个小点，点表示将代码放到当前目录下。<br>http….是指获取wsdl说明书的地址.</p>\n<h4 id=\"客户端编写\"><a href=\"#客户端编写\" class=\"headerlink\" title=\"客户端编写\"></a>客户端编写</h4><p>将上面使用wsimport生成的代码拷贝到项目中，然后编写客户端调用的代码<br>1、使用服务视图调用WebService<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//创建服务视图</span></div><div class=\"line\">WeatherInterfaceImplService weatherInterfaceImplService = <span class=\"keyword\">new</span> WeatherInterfaceImplService();</div><div class=\"line\"><span class=\"comment\">//通过服务视图得到服务断点</span></div><div class=\"line\">WeatherInterfaceImpl port = weatherInterfaceImplService.getPort(WeatherInterfaceImpl.class);</div><div class=\"line\">String result = port.queryWeather(<span class=\"string\">\"深圳\"</span>);</div><div class=\"line\">System.out.println(result);</div></pre></td></tr></table></figure></p>\n<p>2、使用jdk的service类调用webservice<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//wsdl路径</span></div><div class=\"line\">URL wsdlUrl = <span class=\"keyword\">new</span> URL(<span class=\"string\">\"http://127.0.0.1:1234/webther?wsdl\"</span>);</div><div class=\"line\"><span class=\"comment\">//从wsdl中找到服务视图</span></div><div class=\"line\"><span class=\"comment\">//第一个参数是wsdl的命名空间</span></div><div class=\"line\"><span class=\"comment\">//第二个参数是服务视图的名字</span></div><div class=\"line\">QName qName = <span class=\"keyword\">new</span> QName(<span class=\"string\">\"http://jaxws.wqh.com/\"</span>, <span class=\"string\">\"WeatherInterfaceImplService\"</span>);</div><div class=\"line\"><span class=\"comment\">//创建service对象获取服务视图</span></div><div class=\"line\">Service service = Service.create(wsdlUrl,qName);</div><div class=\"line\"><span class=\"comment\">//从服务视图中获取portType</span></div><div class=\"line\">WeatherInterfaceImpl weatherInterface = service.getPort(WeatherInterfaceImpl.class);</div><div class=\"line\"><span class=\"comment\">//调用portType的方法</span></div><div class=\"line\">String result = weatherInterface.queryWeather(<span class=\"string\">\"南昌\"</span>);</div><div class=\"line\">System.out.println(result);</div></pre></td></tr></table></figure></p>\n<h2 id=\"WebService与Socket比较\"><a href=\"#WebService与Socket比较\" class=\"headerlink\" title=\"WebService与Socket比较\"></a>WebService与Socket比较</h2><p><img src=\"http://i.imgur.com/6x7WBwq.png\" alt=\"\"></p>\n<ul>\n<li>Socket  是基于TCP/ip的传输层协议</li>\n<li>Webservice是基于http协议传输数据，http是基于tcp的应用层协议</li>\n<li>Webservice采用了基于http的soap协议传输数据。</li>\n<li>Socket接口通过流传输，不支持面向对象。</li>\n<li>Webservice 接口支持面向对象，最终webservice将对象进行序列化后通过流传输。</li>\n</ul>\n<p>结论：Webservice采用soap协议进行通信，底层基于socket通信，webservice不需专门针对数据流的发送和接收进行处理，是一种跨平台的面向对象远程调用技术。Socket传输速率更快。</p>\n<h2 id=\"WebService的使用介绍\"><a href=\"#WebService的使用介绍\" class=\"headerlink\" title=\"WebService的使用介绍\"></a>WebService的使用介绍</h2><h3 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h3><ol>\n<li>应用程序集成<br>分布式程序之间进行集成使用webservice直接调用服务层方法，不仅缩短了开发周期，还减少了代码复杂度，并能够增强应用程序的可维护性，因为webservice支持跨平台且遵循标准协议（soap）。</li>\n<li>软件重用<br>将一个软件的功能以webservice方式暴露出来，达到软件重用。例如上边分析的天气预报，将天气查询功能以webservice接口方式暴露出来非常容易集成在其它系统中；再比如一个第三方物流系统将快递查询、快递登记暴露出来，从而集成在电子商务系统中。</li>\n</ol>\n<h3 id=\"建议不用webservice\"><a href=\"#建议不用webservice\" class=\"headerlink\" title=\"建议不用webservice\"></a>建议不用webservice</h3><ol>\n<li>同构程序间通信<br>同构程序是指采用相同的编程语言的程序之间通信，比如java远程调用RMi技术就可以非常高效的实现远程调用，使用简单方便，必需保证两边应用都是java编写才可使用。</li>\n</ol>\n<p>总之，只要有其它方法比webservice更高效更可行就不要用webservice，因为web跨平台远程调用方法不止webservice一种，需要择优考虑。<br>RMI是java语言提供的远程调用技术。Rmi速度会比webservice快的多，比socket要慢。</p>\n<h3 id=\"建议使用webservice\"><a href=\"#建议使用webservice\" class=\"headerlink\" title=\"建议使用webservice\"></a>建议使用webservice</h3><ol>\n<li>公开接口<br>面向互联网公开的接口，例如：某公司产品促销介绍、股票信息查询等，因为webservice是互联网的一个标准协议，将接口发布为webservice，其它公司很容易使用。</li>\n<li>调用webservice服务端<br>你作为客户端要调用别人的接口，对方接口用的是webservice，这时你也用webservice开发客户端，且协议版本要和服务端保持一致。</li>\n</ol>\n<h3 id=\"Webservice优缺点\"><a href=\"#Webservice优缺点\" class=\"headerlink\" title=\"Webservice优缺点\"></a>Webservice优缺点</h3><p>优点：</p>\n<ol>\n<li>采用xml支持跨平台远程调用。</li>\n<li>基于http的soap协议，可跨越防火墙。</li>\n<li>支持面向对象开发。</li>\n<li>有利于软件和数据重用，实现松耦合。</li>\n</ol>\n<p>缺点：<br>由于soap是基于xml传输，本身使用xml传输会传输一些无关的东西从而效率不高，随着soap协议的完善，soap协议增加了许多内容，这样就导致了使用soap协议去完成简单的数据传输的效率不高。如果直接用http传输自定义数据内容比webservice开发更快捷，例如第三方支付公司的支持接口。</p>\n","tags":[{"name":"webservice","slug":"webservice","permalink":"http://www.wanqhblog.top/tags/webservice/"}]},{"title":"使用JavaMail发送邮件（带附件）","date":"2017-08-20T09:36:06.000Z","path":"2017/08/20/javamail/","content":"<p>在使用javaMail发邮件之前先简单说一下邮件的三个协议：</p>\n<ol>\n<li>POP3：POP的全称是 Post Office Protocol ，即邮局协议，用于电子邮件的接收，它使用TCP的110端口，现在常用的是第三版，所以简称为 POP3。 <a id=\"more\"></a></li>\n<li>SMTP：SMTP（Simple Mail Transfer Protocal）称为简单邮件传输协议，目标是向用户提供高效、可靠的邮件传输。</li>\n<li>IMAP：<br>IMAP是Internet Message Access Protocol的缩写，顾名思义，主要提供的是通过Internet获取信息的一种协议。</li>\n</ol>\n<h2 id=\"前期准备\"><a href=\"#前期准备\" class=\"headerlink\" title=\"前期准备\"></a>前期准备</h2><p>如果是使用像QQ邮箱、163邮箱、126邮箱等这种普通的邮箱，需要先开启POP3/SMTP/IMAP服务，并且获取授权。如果是企业邮箱，可以直接使用。这里以163邮箱为例。</p>\n<p><img src=\"http://i.imgur.com/5fMcgQh.png\" alt=\"\"><br>先查看是否开启服务<br><img src=\"http://i.imgur.com/YU0igMq.png\" alt=\"\"><br>开启并设置客户端授权码，这个很重要。如果是qq邮箱，需要发短信配置</p>\n<h2 id=\"jar包\"><a href=\"#jar包\" class=\"headerlink\" title=\"jar包\"></a>jar包</h2><p>javaMail需要两个jar，直接使用maven导入依赖</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;dependency&gt;</div><div class=\"line\">          &lt;groupId&gt;javax.activation&lt;/groupId&gt;</div><div class=\"line\">          &lt;artifactId&gt;activation&lt;/artifactId&gt;</div><div class=\"line\">          &lt;version&gt;1.1.1&lt;/version&gt;</div><div class=\"line\">      &lt;/dependency&gt;</div><div class=\"line\">      &lt;dependency&gt;</div><div class=\"line\">          &lt;groupId&gt;com.sun.mail&lt;/groupId&gt;</div><div class=\"line\">          &lt;artifactId&gt;javax.mail&lt;/artifactId&gt;</div><div class=\"line\">          &lt;version&gt;1.5.2&lt;/version&gt;</div><div class=\"line\">      &lt;/dependency&gt;</div></pre></td></tr></table></figure>\n<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//主机名,上面在开启POP3/SMTP/IMAP服务的时候有服务器地址</span></div><div class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String HOST_NAME = <span class=\"string\">\"smtp.126.com\"</span>;</div><div class=\"line\">   <span class=\"comment\">//用户名，邮箱的登陆名</span></div><div class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String USER_NAME = <span class=\"string\">\"xxxxx\"</span>;</div><div class=\"line\">   <span class=\"comment\">//密码，这里是开始设置的授权码</span></div><div class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String USER_PASSWD = <span class=\"string\">\"xxxxx\"</span>;</div><div class=\"line\">   <span class=\"comment\">//发件人</span></div><div class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String FROM_NAME = <span class=\"string\">\"xxxxx\"</span>;</div><div class=\"line\">   <span class=\"comment\">//抄送人</span></div><div class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String CC_NAME = <span class=\"string\">\"xxxxx\"</span>;</div><div class=\"line\"></div><div class=\"line\">   <span class=\"comment\">/**</span></div><div class=\"line\"><span class=\"comment\">    * <span class=\"doctag\">@param</span> toEmail 发送给谁</span></div><div class=\"line\"><span class=\"comment\">    * <span class=\"doctag\">@param</span> code   发送的内容，验证码</span></div><div class=\"line\"><span class=\"comment\">    */</span></div><div class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">sendMail</span><span class=\"params\">(String toEmail, String code)</span> </span>&#123;</div><div class=\"line\">       <span class=\"comment\">//1：创建Properties</span></div><div class=\"line\">       Properties properties = <span class=\"keyword\">new</span> Properties();</div><div class=\"line\">       properties.put(<span class=\"string\">\"mail.host\"</span>, HOST_NAME);</div><div class=\"line\">       properties.put(<span class=\"string\">\"mail.smtp.auth\"</span>, <span class=\"string\">\"true\"</span>);</div><div class=\"line\">       <span class=\"comment\">//2：获取用户名和密码进行认证</span></div><div class=\"line\">       Authenticator authenticator = <span class=\"keyword\">new</span> Authenticator() &#123;</div><div class=\"line\">           <span class=\"meta\">@Override</span></div><div class=\"line\">           <span class=\"function\"><span class=\"keyword\">protected</span> PasswordAuthentication <span class=\"title\">getPasswordAuthentication</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">               <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> PasswordAuthentication(USER_NAME, USER_PASSWD);</div><div class=\"line\">           &#125;</div><div class=\"line\">       &#125;;</div><div class=\"line\">       <span class=\"comment\">//3：获取session对象</span></div><div class=\"line\">       Session session = Session.getInstance(properties, authenticator);</div><div class=\"line\">       <span class=\"comment\">//4：设置邮件发送信息</span></div><div class=\"line\">       Message message = <span class=\"keyword\">new</span> MimeMessage(session);</div><div class=\"line\">       <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">           <span class=\"comment\">//4.1：设置发件人</span></div><div class=\"line\">           message.setFrom(<span class=\"keyword\">new</span> InternetAddress(FROM_NAME));</div><div class=\"line\">           <span class=\"comment\">//4.2：设置收件人</span></div><div class=\"line\">\t\t<span class=\"comment\">//Message.RecipientType.TO 收件人</span></div><div class=\"line\">\t\t<span class=\"comment\">//Message.RecipientType.CC 抄送</span></div><div class=\"line\">\t\t<span class=\"comment\">//Message.RecipientType.BCC 暗送</span></div><div class=\"line\">           message.setRecipient(Message.RecipientType.TO, <span class=\"keyword\">new</span> InternetAddress(toEmail));</div><div class=\"line\">           <span class=\"comment\">//4.3：设置邮件主题</span></div><div class=\"line\">           message.setSubject(<span class=\"string\">\"主题！！\"</span>);</div><div class=\"line\">           <span class=\"comment\">//4.4：设置邮件正文</span></div><div class=\"line\">           message.setContent(code,<span class=\"string\">\"text/html;charset=utf-8\"</span>);</div><div class=\"line\">           <span class=\"comment\">//5：发送邮件</span></div><div class=\"line\">           Transport.send(message);</div><div class=\"line\">       &#125; <span class=\"keyword\">catch</span> (MessagingException e) &#123;</div><div class=\"line\">           e.printStackTrace();</div><div class=\"line\">       &#125;</div><div class=\"line\">   &#125;</div></pre></td></tr></table></figure>","tags":[{"name":"javamail","slug":"javamail","permalink":"http://www.wanqhblog.top/tags/javamail/"}]},{"title":"Redis入门之环境的搭建","date":"2017-08-20T05:09:50.000Z","path":"2017/08/20/Redis入门之环境的搭建/","content":"<h2 id=\"一、-Ubuntu下redis的搭建\"><a href=\"#一、-Ubuntu下redis的搭建\" class=\"headerlink\" title=\"一、 Ubuntu下redis的搭建\"></a>一、 Ubuntu下redis的搭建</h2><p>这里直接使用命令下载以及安装，<br><a id=\"more\"></a></p>\n<h3 id=\"1、下载redis\"><a href=\"#1、下载redis\" class=\"headerlink\" title=\"1、下载redis\"></a>1、下载redis</h3><p>首先进入root下</p>\n<pre><code>root@ubuntu:~# wget http://download.redis.io/releases/redis-4.0.1.tar.gz\n</code></pre><h3 id=\"2、解压\"><a href=\"#2、解压\" class=\"headerlink\" title=\"2、解压\"></a>2、解压</h3><p>这里可以直接使用解压命令解压文件</p>\n<pre><code>root@ubuntu:~# tar -xzvf redis-4.0.1.tar.gz \n</code></pre><h3 id=\"3、编译安装\"><a href=\"#3、编译安装\" class=\"headerlink\" title=\"3、编译安装\"></a>3、编译安装</h3><p>解压完成后进入到解压后的目录中使用make命令既可编译</p>\n<figure>\n\n<pre><code>root@ubuntu:~# cd redis-4.0.1\nroot@ubuntu:~/redis-4.0.1# make\n</code></pre><p></p></figure><br><img src=\"http://i.imgur.com/OLbC1eB.png\" alt=\"\"><p></p>\n<p>如上图所示如果没有错误为编译成功</p>\n<p>输入make test命令测试是否安装成功</p>\n<pre><code>root@ubuntu:~/redis-4.0.1# make test\n</code></pre><p><img src=\"http://i.imgur.com/7uhWPED.png\" alt=\"\"></p>\n<p>这里第一次可能会出现错误，如果出现错误可以再次执行该命令</p>\n<h3 id=\"4、启动redis\"><a href=\"#4、启动redis\" class=\"headerlink\" title=\"4、启动redis\"></a>4、启动redis</h3><pre><code>root@ubuntu:~/redis-4.0.1# cd src/\nroot@ubuntu:~/redis-4.0.1/src# ls\n</code></pre><p>在redis的根目录下查看是否含有redis.conf文件</p>\n<p><img src=\"http://i.imgur.com/GDekIrp.png\" alt=\"\"></p>\n<p>然后进入到src目录中使用ls命令查看是否包含以下文件</p>\n<p><img src=\"http://i.imgur.com/n5F2V47.png\" alt=\"\"></p>\n<p>将redis添加到Path环境变量中，方便下次直接启动redis</p>\n<pre><code>root@ubuntu:~/redis-4.0.1/src# cp redis-server /usr/local/bin/\nroot@ubuntu:~/redis-4.0.1/src# cp redis-cli /usr/local/bin/\n</code></pre><p>使用命令启动redis</p>\n<pre><code>root@ubuntu:~/redis-4.0.1/src# redis-server \n</code></pre><p><img src=\"http://i.imgur.com/2WyODnB.png\" alt=\"\"></p>\n<p>如图表示服务启动成功，不要关闭该终端，使用shift+ctrl+t开启一个新的终端，输入redis-cli命令进入redis</p>\n<p><img src=\"http://i.imgur.com/emLpYDY.png\" alt=\"\"></p>\n<p>配置成功</p>\n<p>另外在Ubuntu中可以直接使用apt-get命令安装，这里直接盗用<a href=\"https://www.runoob.com/redis/redis-install.html\" title=\"菜鸟教程\" target=\"_blank\" rel=\"external\">菜鸟教程</a>了。<br><img src=\"http://i.imgur.com/sF1LCM8.png\" alt=\"\"></p>\n<h2 id=\"二、在window中搭建\"><a href=\"#二、在window中搭建\" class=\"headerlink\" title=\"二、在window中搭建\"></a>二、在window中搭建</h2><p>这使用的是win7-64的系统</p>\n<h3 id=\"1、首先当然是下载\"><a href=\"#1、首先当然是下载\" class=\"headerlink\" title=\"1、首先当然是下载\"></a>1、首先当然是下载</h3><p><a href=\"https://github.com/MicrosoftArchive/redis/releases\" target=\"_blank\" rel=\"external\">redis下载地址</a></p>\n<p><img src=\"http://i.imgur.com/pugaQ5M.png\" alt=\"\"></p>\n<h3 id=\"2、安装\"><a href=\"#2、安装\" class=\"headerlink\" title=\"2、安装\"></a>2、安装</h3><p>安装版的直接点下一步就行了，安装完成之后直接进入在命令行中输入redis-cli既可<br><img src=\"http://i.imgur.com/E9EFy95.png\" alt=\"\"></p>\n<p>如果是解压版的需要解压后，进入到解压后的目录中使用redis-server命令启动服务既可使用。</p>\n<h2 id=\"三、连接远程redis\"><a href=\"#三、连接远程redis\" class=\"headerlink\" title=\"三、连接远程redis\"></a>三、连接远程redis</h2><p><img src=\"http://i.imgur.com/gjVNyMe.png\" alt=\"\"></p>\n<p>-h后面为连接主机的ip地址，-p为端口号</p>\n","tags":[{"name":"redis","slug":"redis","permalink":"http://www.wanqhblog.top/tags/redis/"}]}]